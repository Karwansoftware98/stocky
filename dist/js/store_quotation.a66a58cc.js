"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[2233],{30361:(t,e,i)=>{i.r(e),i.d(e,{default:()=>lt});var a=i(20641),s=i(53751),l=i(90033);const d={class:"main-content"},o={key:0,class:"loading_page spinner spinner-primary mr-3"},u={id:"autocomplete",class:"autocomplete"},r=["placeholder"],n={class:"autocomplete-result-list"},c=["onMousedown"],_={class:"table-responsive"},h={class:"table table-hover"},p={class:"bg-gray-300"},b=(0,a.Lk)("th",{scope:"col"},"#",-1),m={scope:"col"},k={scope:"col"},f={scope:"col"},g={scope:"col"},v={scope:"col"},q={scope:"col"},F={scope:"col"},y=(0,a.Lk)("th",{scope:"col",class:"text-center"},[(0,a.Lk)("i",{class:"fa fa-trash"})],-1),x={key:0},$={colspan:"9"},L=(0,a.Lk)("br",null,null,-1),U={class:"badge badge-success"},S={key:0,class:"badge badge-warning"},T={key:1,class:"badge badge-warning"},C={class:"quantity"},V=["onClick"],w=["onKeyup","max","onUpdate:modelValue"],D=["onClick"],N=["onClick"],P=["onClick"],W={class:"offset-md-9 col-md-3 mt-4"},M={class:"table table-striped table-sm"},Q={class:"bold"},E={class:"bold"},X={class:"bold"},G={class:"font-weight-bold"},I={class:"font-weight-bold"},O=["placeholder"],A=(0,a.Lk)("i",{class:"i-Yes me-2 font-weight-bold"},null,-1),K={key:0,class:"typo__p"},B=(0,a.Lk)("div",{class:"spinner sm spinner-primary mt-3"},null,-1),R=[B],J=(0,a.Lk)("i",{class:"i-Yes me-2 font-weight-bold"},null,-1),Y={key:0,class:"typo__p"},z=(0,a.Lk)("div",{class:"spinner sm spinner-primary mt-3"},null,-1),j=[z];function H(t,e,i,B,z,H){const Z=(0,a.g2)("breadcumb"),tt=(0,a.g2)("b-form-input"),et=(0,a.g2)("b-form-invalid-feedback"),it=(0,a.g2)("b-form-group"),at=(0,a.g2)("validation-provider"),st=(0,a.g2)("b-col"),lt=(0,a.g2)("v-select"),dt=(0,a.g2)("b-input-group-prepend"),ot=(0,a.g2)("b-input-group-append"),ut=(0,a.g2)("b-input-group"),rt=(0,a.g2)("b-button"),nt=(0,a.g2)("b-row"),ct=(0,a.g2)("b-card"),_t=(0,a.g2)("b-form"),ht=(0,a.g2)("validation-observer"),pt=(0,a.g2)("b-modal");return(0,a.uX)(),(0,a.CE)("div",d,[(0,a.bF)(Z,{page:t.$t("AddQuote"),folder:t.$t("ListQuotations")},null,8,["page","folder"]),z.isLoading?((0,a.uX)(),(0,a.CE)("div",o)):(0,a.Q3)("",!0),z.isLoading?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(ht,{key:1,ref:"create_quote"},{default:(0,a.k6)((()=>[(0,a.bF)(_t,{onSubmit:(0,s.D$)(H.Submit_Quotation,["prevent"])},{default:(0,a.k6)((()=>[(0,a.bF)(nt,null,{default:(0,a.k6)((()=>[(0,a.bF)(st,{lg:"12",md:"12",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(ct,null,{default:(0,a.k6)((()=>[(0,a.bF)(nt,null,{default:(0,a.k6)((()=>[(0,a.bF)(st,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"date",rules:{required:!0}},{default:(0,a.k6)((i=>[(0,a.bF)(it,{label:t.$t("date")+" *"},{default:(0,a.k6)((()=>[(0,a.bF)(tt,{state:H.getValidationState(i),"aria-describedby":"date-feedback",type:"date",modelValue:z.quote.date,"onUpdate:modelValue":e[0]||(e[0]=t=>z.quote.date=t)},null,8,["state","modelValue"]),(0,a.bF)(et,{id:"OrderTax-feedback"},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(i.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,a.bF)(st,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Customer",rules:{required:!0}},{default:(0,a.k6)((()=>[(0,a.bF)(it,{"slot-scope":"{ valid, errors }",label:t.$t("Customer")+" *"},{default:(0,a.k6)((()=>[(0,a.bF)(lt,{class:(0,l.C4)({"is-invalid":!!t.errors.length}),state:!t.errors[0]&&(!!t.valid||null),modelValue:z.quote.client_id,"onUpdate:modelValue":e[1]||(e[1]=t=>z.quote.client_id=t),reduce:t=>t.value,placeholder:t.$t("Choose_Customer"),options:z.clients.map((t=>({label:t.name,value:t.id})))},null,8,["class","state","modelValue","reduce","placeholder","options"]),(0,a.bF)(et,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(t.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,a.bF)(st,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"warehouse",rules:{required:!0}},{default:(0,a.k6)((()=>[(0,a.bF)(it,{"slot-scope":"{ valid, errors }",label:t.$t("warehouse")+" *"},{default:(0,a.k6)((()=>[(0,a.bF)(lt,{class:(0,l.C4)({"is-invalid":!!t.errors.length}),state:!t.errors[0]&&(!!t.valid||null),disabled:z.details.length>0,onInput:H.Selected_Warehouse,modelValue:z.quote.warehouse_id,"onUpdate:modelValue":e[2]||(e[2]=t=>z.quote.warehouse_id=t),reduce:t=>t.value,placeholder:t.$t("Choose_Warehouse"),options:z.warehouses.map((t=>({label:t.name,value:t.id})))},null,8,["class","state","disabled","onInput","modelValue","reduce","placeholder","options"]),(0,a.bF)(et,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(t.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,a.bF)(st,{md:"12",class:"mb-5"},{default:(0,a.k6)((()=>[(0,a.Lk)("h6",null,(0,l.v_)(t.$t("ProductName")),1),(0,a.Lk)("div",u,[(0,a.Lk)("input",{placeholder:t.$t("Scan_Search_Product_by_Code_Name"),onInput:e[3]||(e[3]=t=>z.search_input=t.target.value),onKeyup:e[4]||(e[4]=t=>H.search(z.search_input)),onFocus:e[5]||(e[5]=(...t)=>H.handleFocus&&H.handleFocus(...t)),onBlur:e[6]||(e[6]=(...t)=>H.handleBlur&&H.handleBlur(...t)),ref:"product_autocomplete",class:"autocomplete-input"},null,40,r),(0,a.bo)((0,a.Lk)("ul",n,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(z.product_filter,(t=>((0,a.uX)(),(0,a.CE)("li",{class:"autocomplete-result",onMousedown:e=>H.SearchProduct(t)},(0,l.v_)(H.getResultValue(t)),41,c)))),256))],512),[[s.aG,z.focused]])])])),_:1}),(0,a.bF)(st,{md:"12"},{default:(0,a.k6)((()=>[(0,a.Lk)("h5",null,(0,l.v_)(t.$t("order_products"))+" *",1),(0,a.Lk)("div",_,[(0,a.Lk)("table",h,[(0,a.Lk)("thead",p,[(0,a.Lk)("tr",null,[b,(0,a.Lk)("th",m,(0,l.v_)(t.$t("ProductName")),1),(0,a.Lk)("th",k,(0,l.v_)(t.$t("Net_Unit_Price")),1),(0,a.Lk)("th",f,(0,l.v_)(t.$t("CurrentStock")),1),(0,a.Lk)("th",g,(0,l.v_)(t.$t("Qty")),1),(0,a.Lk)("th",v,(0,l.v_)(t.$t("Discount")),1),(0,a.Lk)("th",q,(0,l.v_)(t.$t("Tax")),1),(0,a.Lk)("th",F,(0,l.v_)(t.$t("SubTotal")),1),y])]),(0,a.Lk)("tbody",null,[z.details.length<=0?((0,a.uX)(),(0,a.CE)("tr",x,[(0,a.Lk)("td",$,(0,l.v_)(t.$t("NodataAvailable")),1)])):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(z.details,(e=>((0,a.uX)(),(0,a.CE)("tr",null,[(0,a.Lk)("td",null,(0,l.v_)(e.detail_id),1),(0,a.Lk)("td",null,[(0,a.Lk)("span",null,(0,l.v_)(e.code),1),L,(0,a.Lk)("span",U,(0,l.v_)(e.name),1)]),(0,a.Lk)("td",null,(0,l.v_)(t.currentUser.currency)+" "+(0,l.v_)(H.formatNumber(e.Net_price,3)),1),(0,a.Lk)("td",null,["is_service"==e.product_type?((0,a.uX)(),(0,a.CE)("span",S,"----")):((0,a.uX)(),(0,a.CE)("span",T,(0,l.v_)(e.stock)+" "+(0,l.v_)(e.unitSale),1))]),(0,a.Lk)("td",null,[(0,a.Lk)("div",C,[(0,a.bF)(ut,null,{default:(0,a.k6)((()=>[(0,a.bF)(dt,null,{default:(0,a.k6)((()=>[(0,a.Lk)("span",{class:"btn btn-primary btn-sm",onClick:t=>H.decrement(e,e.detail_id)},"-",8,V)])),_:2},1024),(0,a.bo)((0,a.Lk)("input",{class:"form-control",onKeyup:t=>H.Verified_Qty(e,e.detail_id),min:0,max:e.stock,"onUpdate:modelValue":t=>e.quantity=t},null,40,w),[[s.Jo,e.quantity,void 0,{number:!0}]]),(0,a.bF)(ot,null,{default:(0,a.k6)((()=>[(0,a.Lk)("span",{class:"btn btn-primary btn-sm",onClick:t=>H.increment(e,e.detail_id)},"+",8,D)])),_:2},1024)])),_:2},1024)])]),(0,a.Lk)("td",null,(0,l.v_)(t.currentUser.currency)+" "+(0,l.v_)(H.formatNumber(e.DiscountNet*e.quantity,2)),1),(0,a.Lk)("td",null,(0,l.v_)(t.currentUser.currency)+" "+(0,l.v_)(H.formatNumber(e.taxe*e.quantity,2)),1),(0,a.Lk)("td",null,(0,l.v_)(t.currentUser.currency)+" "+(0,l.v_)(e.subtotal.toFixed(2)),1),(0,a.Lk)("td",null,[t.currentUserPermissions&&t.currentUserPermissions.includes("edit_product_quotation")?((0,a.uX)(),(0,a.CE)("i",{key:0,onClick:t=>H.Modal_Updat_Detail(e),class:"i-Edit text-25 text-success cursor-pointer"},null,8,N)):(0,a.Q3)("",!0),(0,a.Lk)("i",{onClick:t=>H.delete_Product_Detail(e.detail_id),class:"i-Close-Window text-25 text-danger cursor-pointer"},null,8,P)])])))),256))])])])])),_:1}),(0,a.Lk)("div",W,[(0,a.Lk)("table",M,[(0,a.Lk)("tbody",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",Q,(0,l.v_)(t.$t("OrderTax")),1),(0,a.Lk)("td",null,[(0,a.Lk)("span",null,(0,l.v_)(t.currentUser.currency)+" "+(0,l.v_)(z.quote.TaxNet.toFixed(2))+" ("+(0,l.v_)(H.formatNumber(z.quote.tax_rate,2))+" %)",1)])]),(0,a.Lk)("tr",null,[(0,a.Lk)("td",E,(0,l.v_)(t.$t("Discount")),1),(0,a.Lk)("td",null,(0,l.v_)(t.currentUser.currency)+" "+(0,l.v_)(z.quote.discount.toFixed(2)),1)]),(0,a.Lk)("tr",null,[(0,a.Lk)("td",X,(0,l.v_)(t.$t("Shipping")),1),(0,a.Lk)("td",null,(0,l.v_)(t.currentUser.currency)+" "+(0,l.v_)(z.quote.shipping.toFixed(2)),1)]),(0,a.Lk)("tr",null,[(0,a.Lk)("td",null,[(0,a.Lk)("span",G,(0,l.v_)(t.$t("Total")),1)]),(0,a.Lk)("td",null,[(0,a.Lk)("span",I,(0,l.v_)(t.currentUser.currency)+" "+(0,l.v_)(z.GrandTotal.toFixed(2)),1)])])])])]),t.currentUserPermissions&&t.currentUserPermissions.includes("edit_tax_discount_shipping_quotation")?((0,a.uX)(),(0,a.Wv)(st,{key:0,lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Order Tax",rules:{regex:/^\d*\.?\d*$/}},{default:(0,a.k6)((i=>[(0,a.bF)(it,{label:t.$t("OrderTax")},{default:(0,a.k6)((()=>[(0,a.bF)(ut,{append:"%"},{default:(0,a.k6)((()=>[(0,a.bF)(tt,{state:H.getValidationState(i),"aria-describedby":"OrderTax-feedback",label:"Order Tax",modelValue:z.quote.tax_rate,"onUpdate:modelValue":e[7]||(e[7]=t=>z.quote.tax_rate=t),modelModifiers:{number:!0},onKeyup:e[8]||(e[8]=t=>H.keyup_OrderTax())},null,8,["state","modelValue"])])),_:2},1024),(0,a.bF)(et,{id:"OrderTax-feedback"},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(i.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1})):(0,a.Q3)("",!0),t.currentUserPermissions&&t.currentUserPermissions.includes("edit_tax_discount_shipping_quotation")?((0,a.uX)(),(0,a.Wv)(st,{key:1,lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Discount",rules:{regex:/^\d*\.?\d*$/}},{default:(0,a.k6)((i=>[(0,a.bF)(it,{label:t.$t("Discount")},{default:(0,a.k6)((()=>[(0,a.bF)(ut,{append:t.currentUser.currency},{default:(0,a.k6)((()=>[(0,a.bF)(tt,{state:H.getValidationState(i),"aria-describedby":"Discount-feedback",label:"Discount",modelValue:z.quote.discount,"onUpdate:modelValue":e[9]||(e[9]=t=>z.quote.discount=t),modelModifiers:{number:!0},onKeyup:e[10]||(e[10]=t=>H.keyup_Discount())},null,8,["state","modelValue"])])),_:2},1032,["append"]),(0,a.bF)(et,{id:"Discount-feedback"},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(i.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1})):(0,a.Q3)("",!0),t.currentUserPermissions&&t.currentUserPermissions.includes("edit_tax_discount_shipping_quotation")?((0,a.uX)(),(0,a.Wv)(st,{key:2,lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Shipping",rules:{regex:/^\d*\.?\d*$/}},{default:(0,a.k6)((i=>[(0,a.bF)(it,{label:t.$t("Shipping")},{default:(0,a.k6)((()=>[(0,a.bF)(ut,{append:t.currentUser.currency},{default:(0,a.k6)((()=>[(0,a.bF)(tt,{state:H.getValidationState(i),"aria-describedby":"Shipping-feedback",label:"Shipping",modelValue:z.quote.shipping,"onUpdate:modelValue":e[11]||(e[11]=t=>z.quote.shipping=t),modelModifiers:{number:!0},onKeyup:e[12]||(e[12]=t=>H.keyup_Shipping())},null,8,["state","modelValue"])])),_:2},1032,["append"]),(0,a.bF)(et,{id:"Shipping-feedback"},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(i.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1})):(0,a.Q3)("",!0),(0,a.bF)(st,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Status",rules:{required:!0}},{default:(0,a.k6)((()=>[(0,a.bF)(it,{"slot-scope":"{ valid, errors }",label:t.$t("Status")+" *"},{default:(0,a.k6)((()=>[(0,a.bF)(lt,{class:(0,l.C4)({"is-invalid":!!t.errors.length}),state:!t.errors[0]&&(!!t.valid||null),modelValue:z.quote.statut,"onUpdate:modelValue":e[13]||(e[13]=t=>z.quote.statut=t),reduce:t=>t.value,placeholder:t.$t("Choose_Status"),options:[{label:"Sent",value:"sent"},{label:"Pending",value:"pending"}]},null,8,["class","state","modelValue","reduce","placeholder"]),(0,a.bF)(et,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(t.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,a.bF)(st,{md:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(it,{label:t.$t("Note")},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":e[14]||(e[14]=t=>z.quote.notes=t),rows:"4",class:"form-control",placeholder:t.$t("Afewwords")},null,8,O),[[s.Jo,z.quote.notes]])])),_:1},8,["label"])])),_:1}),(0,a.bF)(st,{md:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(it,null,{default:(0,a.k6)((()=>[(0,a.bF)(rt,{variant:"primary",onClick:H.Submit_Quotation,disabled:z.SubmitProcessing},{default:(0,a.k6)((()=>[A,(0,a.eW)(" "+(0,l.v_)(t.$t("submit")),1)])),_:1},8,["onClick","disabled"]),e[15]||((0,a.Vq)(-1),e[15]=z.SubmitProcessing?((0,a.uX)(),(0,a.CE)("div",K,R)):(0,a.Q3)("",!0),(0,a.Vq)(1),e[15])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1},512)),(0,a.bF)(ht,{ref:"Update_Detail_quote"},{default:(0,a.k6)((()=>[(0,a.bF)(pt,{"hide-footer":"",size:"lg",id:"form_Update_Detail",title:z.detail.name},{default:(0,a.k6)((()=>[(0,a.bF)(_t,{onSubmit:(0,s.D$)(H.submit_Update_Detail,["prevent"])},{default:(0,a.k6)((()=>[(0,a.bF)(nt,null,{default:(0,a.k6)((()=>[(0,a.bF)(st,{lg:"6",md:"6",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Product Price",rules:{required:!0,regex:/^\d*\.?\d*$/}},{default:(0,a.k6)((i=>[(0,a.bF)(it,{label:t.$t("ProductPrice")+" *",id:"Price-input"},{default:(0,a.k6)((()=>[(0,a.bF)(tt,{label:"Product Price",modelValue:z.detail.Unit_price,"onUpdate:modelValue":e[16]||(e[16]=t=>z.detail.Unit_price=t),state:H.getValidationState(i),"aria-describedby":"Price-feedback"},null,8,["modelValue","state"]),(0,a.bF)(et,{id:"Price-feedback"},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(i.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,a.bF)(st,{lg:"6",md:"6",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Tax Method",rules:{required:!0}},{default:(0,a.k6)((()=>[(0,a.bF)(it,{"slot-scope":"{ valid, errors }",label:t.$t("TaxMethod")+" *"},{default:(0,a.k6)((()=>[(0,a.bF)(lt,{class:(0,l.C4)({"is-invalid":!!t.errors.length}),state:!t.errors[0]&&(!!t.valid||null),modelValue:z.detail.tax_method,"onUpdate:modelValue":e[17]||(e[17]=t=>z.detail.tax_method=t),reduce:t=>t.value,placeholder:t.$t("Choose_Method"),options:[{label:"Exclusive",value:"1"},{label:"Inclusive",value:"2"}]},null,8,["class","state","modelValue","reduce","placeholder"]),(0,a.bF)(et,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(t.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,a.bF)(st,{lg:"6",md:"6",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Order Tax",rules:{required:!0,regex:/^\d*\.?\d*$/}},{default:(0,a.k6)((i=>[(0,a.bF)(it,{label:t.$t("OrderTax")+" *"},{default:(0,a.k6)((()=>[(0,a.bF)(ut,{append:"%"},{default:(0,a.k6)((()=>[(0,a.bF)(tt,{label:"Order Tax",modelValue:z.detail.tax_percent,"onUpdate:modelValue":e[18]||(e[18]=t=>z.detail.tax_percent=t),state:H.getValidationState(i),"aria-describedby":"OrderTax-feedback"},null,8,["modelValue","state"])])),_:2},1024),(0,a.bF)(et,{id:"OrderTax-feedback"},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(i.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,a.bF)(st,{lg:"6",md:"6",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Discount Method",rules:{required:!0}},{default:(0,a.k6)((()=>[(0,a.bF)(it,{"slot-scope":"{ valid, errors }",label:t.$t("Discount_Method")+" *"},{default:(0,a.k6)((()=>[(0,a.bF)(lt,{modelValue:z.detail.discount_Method,"onUpdate:modelValue":e[19]||(e[19]=t=>z.detail.discount_Method=t),reduce:t=>t.value,placeholder:t.$t("Choose_Method"),class:(0,l.C4)({"is-invalid":!!t.errors.length}),state:!t.errors[0]&&(!!t.valid||null),options:[{label:"Percent %",value:"1"},{label:"Fixed",value:"2"}]},null,8,["modelValue","reduce","placeholder","class","state"]),(0,a.bF)(et,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(t.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,a.bF)(st,{lg:"6",md:"6",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Discount Rate",rules:{required:!0,regex:/^\d*\.?\d*$/}},{default:(0,a.k6)((i=>[(0,a.bF)(it,{label:t.$t("Discount")+" *"},{default:(0,a.k6)((()=>[(0,a.bF)(tt,{label:"Discount",modelValue:z.detail.discount,"onUpdate:modelValue":e[20]||(e[20]=t=>z.detail.discount=t),state:H.getValidationState(i),"aria-describedby":"Discount-feedback"},null,8,["modelValue","state"]),(0,a.bF)(et,{id:"Discount-feedback"},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(i.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),"is_service"!=z.detail.product_type?((0,a.uX)(),(0,a.Wv)(st,{key:0,lg:"6",md:"6",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(at,{name:"Unit Sale",rules:{required:!0}},{default:(0,a.k6)((()=>[(0,a.bF)(it,{"slot-scope":"{ valid, errors }",label:t.$t("UnitSale")+" *"},{default:(0,a.k6)((()=>[(0,a.bF)(lt,{class:(0,l.C4)({"is-invalid":!!t.errors.length}),state:!t.errors[0]&&(!!t.valid||null),modelValue:z.detail.sale_unit_id,"onUpdate:modelValue":e[21]||(e[21]=t=>z.detail.sale_unit_id=t),placeholder:t.$t("Choose_Unit_Sale"),reduce:t=>t.value,options:z.units.map((t=>({label:t.name,value:t.id})))},null,8,["class","state","modelValue","placeholder","reduce","options"]),(0,a.bF)(et,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(t.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1})):(0,a.Q3)("",!0),(0,a.bo)((0,a.bF)(st,{lg:"12",md:"12",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(it,{label:t.$t("Add_product_IMEI_Serial_number")},{default:(0,a.k6)((()=>[(0,a.bF)(tt,{label:"Add_product_IMEI_Serial_number",modelValue:z.detail.imei_number,"onUpdate:modelValue":e[22]||(e[22]=t=>z.detail.imei_number=t),placeholder:t.$t("Add_product_IMEI_Serial_number")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},512),[[s.aG,z.detail.is_imei]]),(0,a.bF)(st,{md:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(it,null,{default:(0,a.k6)((()=>[(0,a.bF)(rt,{variant:"primary",type:"submit",disabled:z.Submit_Processing_detail},{default:(0,a.k6)((()=>[J,(0,a.eW)(" "+(0,l.v_)(t.$t("submit")),1)])),_:1},8,["disabled"]),e[23]||((0,a.Vq)(-1),e[23]=z.Submit_Processing_detail?((0,a.uX)(),(0,a.CE)("div",Y,j)):(0,a.Q3)("",!0),(0,a.Vq)(1),e[23])])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1},8,["title"])])),_:1},512)])}var Z=i(95353),tt=i(5947),et=i.n(tt);const it={metaInfo:{title:"Create Quotation"},data(){return{focused:!1,timer:null,search_input:"",product_filter:[],isLoading:!0,SubmitProcessing:!1,Submit_Processing_detail:!1,warehouses:[],units:[],clients:[],products:[],details:[],detail:{},quotations:[],quotation_with_stock:"",quote:{id:"",statut:"pending",notes:"",date:(new Date).toISOString().slice(0,10),client_id:"",warehouse_id:"",tax_rate:0,TaxNet:0,shipping:0,discount:0},total:0,GrandTotal:0,product:{id:"",code:"",product_type:"",stock:"",quantity:1,discount:"",DiscountNet:"",discount_Method:"",sale_unit_id:"",fix_stock:"",fix_price:"",name:"",unitSale:"",Net_price:"",Total_price:"",Unit_price:"",subtotal:"",product_id:"",detail_id:"",taxe:"",tax_percent:"",tax_method:"",product_variant_id:"",is_imei:"",imei_number:""},symbol:""}},computed:{...(0,Z.L8)(["currentUserPermissions","currentUser"])},methods:{handleFocus(){this.focused=!0},handleBlur(){this.focused=!1},Submit_Quotation(){this.$refs.create_quote.validate().then((t=>{t?this.Create_Quotation():this.makeToast("danger",this.$t("Please_fill_the_form_correctly"),this.$t("Failed"))}))},submit_Update_Detail(){this.$refs.Update_Detail_quote.validate().then((t=>{t&&this.Update_Detail()}))},getValidationState({dirty:t,validated:e,valid:i=null}){return t||e?i:null},makeToast(t,e,i){this.$root.$bvToast.toast(e,{title:i,variant:t,solid:!0})},get_units(t){axios.get("get_units?id="+t).then((({data:t})=>this.units=t))},Modal_Updat_Detail(t){et().start(),et().set(.1),this.detail={},this.get_units(t.product_id),this.detail.detail_id=t.detail_id,this.detail.sale_unit_id=t.sale_unit_id,this.detail.name=t.name,this.detail.product_type=t.product_type,this.detail.Unit_price=t.Unit_price,this.detail.fix_price=t.fix_price,this.detail.fix_stock=t.fix_stock,this.detail.stock=t.stock,this.detail.tax_method=t.tax_method,this.detail.discount_Method=t.discount_Method,this.detail.discount=t.discount,this.detail.quantity=t.quantity,this.detail.tax_percent=t.tax_percent,this.detail.is_imei=t.is_imei,this.detail.imei_number=t.imei_number,setTimeout((()=>{et().done(),this.$bvModal.show("form_Update_Detail")}),1e3)},Update_Detail(){et().start(),et().set(.1),this.Submit_Processing_detail=!0;for(var t=0;t<this.details.length;t++)if(this.details[t].detail_id===this.detail.detail_id){for(var e=0;e<this.units.length;e++)this.units[e].id==this.detail.sale_unit_id&&("/"==this.units[e].operator?(this.details[t].stock=this.detail.fix_stock*this.units[e].operator_value,this.details[t].unitSale=this.units[e].ShortName):(this.details[t].stock=this.detail.fix_stock/this.units[e].operator_value,this.details[t].unitSale=this.units[e].ShortName));this.details[t].stock<this.details[t].quantity?this.details[t].quantity=this.details[t].stock:this.details[t].quantity=1,this.details[t].Unit_price=this.detail.Unit_price,this.details[t].tax_percent=this.detail.tax_percent,this.details[t].tax_method=this.detail.tax_method,this.details[t].discount_Method=this.detail.discount_Method,this.details[t].discount=this.detail.discount,this.details[t].sale_unit_id=this.detail.sale_unit_id,this.details[t].imei_number=this.detail.imei_number,this.details[t].product_type=this.detail.product_type,"2"==this.details[t].discount_Method?this.details[t].DiscountNet=this.details[t].discount:this.details[t].DiscountNet=parseFloat(this.details[t].Unit_price*this.details[t].discount/100),"1"==this.details[t].tax_method?(this.details[t].Net_price=parseFloat(this.details[t].Unit_price-this.details[t].DiscountNet),this.details[t].taxe=parseFloat(this.details[t].tax_percent*(this.details[t].Unit_price-this.details[t].DiscountNet)/100)):(this.details[t].Net_price=parseFloat((this.details[t].Unit_price-this.details[t].DiscountNet)/(this.details[t].tax_percent/100+1)),this.details[t].taxe=parseFloat(this.details[t].Unit_price-this.details[t].Net_price-this.details[t].DiscountNet)),this.$forceUpdate()}this.Calcul_Total(),setTimeout((()=>{et().done(),this.Submit_Processing_detail=!1,this.$bvModal.hide("form_Update_Detail")}),1e3)},search(){if(this.timer&&(clearTimeout(this.timer),this.timer=null),this.search_input.length<2)return this.product_filter=[];""!=this.quote.warehouse_id&&null!=this.quote.warehouse_id?this.timer=setTimeout((()=>{const t=this.products.filter((t=>t.code===this.search_input||t.barcode.includes(this.search_input)));1===t.length?this.SearchProduct(t[0]):this.product_filter=this.products.filter((t=>t.name.toLowerCase().includes(this.search_input.toLowerCase())||t.code.toLowerCase().includes(this.search_input.toLowerCase())||t.barcode.toLowerCase().includes(this.search_input.toLowerCase())))}),800):this.makeToast("warning",this.$t("SelectWarehouse"),this.$t("Warning"))},getResultValue(t){return t.code+" ("+t.name+")"},SearchProduct(t){this.product={},this.details.length>0&&this.details.some((e=>e.code===t.code))?this.makeToast("warning",this.$t("AlreadyAdd"),this.$t("Warning")):("is_service"==t.product_type?(this.product.quantity=1,this.product.code=t.code):(this.product.code=t.code,this.product.stock=t.qte_sale,this.product.fix_stock=t.qte,t.qte_sale<1?this.product.quantity=t.qte_sale:this.product.quantity=1),this.product.product_variant_id=t.product_variant_id,this.Get_Product_Details(t.id,t.product_variant_id)),this.search_input="",this.$refs.product_autocomplete.value="",this.product_filter=[]},Selected_Warehouse(t){this.search_input="",this.product_filter=[],this.Get_Products_By_Warehouse(t)},Get_Products_By_Warehouse(t){et().start(),et().set(.1),axios.get("get_Products_by_warehouse/"+t+"?stock="+this.quotation_with_stock+"&product_service=1").then((t=>{this.products=t.data,et().done()})).catch((t=>{}))},add_product(){this.details.length>0?this.Last_Detail_id():0===this.details.length&&(this.product.detail_id=1),this.details.push(this.product),this.product.is_imei&&this.Modal_Updat_Detail(this.product)},Verified_Qty(t,e){for(var i=0;i<this.details.length;i++)this.details[i].detail_id===e&&(isNaN(t.quantity)&&(this.details[i].quantity=t.stock),this.quotation_with_stock&&t.quantity>t.stock?(this.makeToast("warning",this.$t("LowStock"),this.$t("Warning")),this.details[i].quantity=t.stock):this.details[i].quantity=t.quantity);this.$forceUpdate(),this.Calcul_Total()},increment(t,e){for(var i=0;i<this.details.length;i++)this.details[i].detail_id==e&&(this.quotation_with_stock&&t.quantity+1>t.stock?this.makeToast("warning",this.$t("LowStock"),this.$t("Warning")):this.formatNumber(this.details[i].quantity++,2));this.$forceUpdate(),this.Calcul_Total()},decrement(t,e){for(var i=0;i<this.details.length;i++)this.details[i].detail_id==e&&t.quantity-1>0&&(this.quotation_with_stock&&t.quantity-1>t.stock?this.makeToast("warning",this.$t("LowStock"),this.$t("Warning")):this.formatNumber(this.details[i].quantity--,2));this.$forceUpdate(),this.Calcul_Total()},keyup_OrderTax(){isNaN(this.quote.tax_rate)?this.quote.tax_rate=0:""==this.quote.tax_rate?(this.quote.tax_rate=0,this.Calcul_Total()):this.Calcul_Total()},keyup_Discount(){isNaN(this.quote.discount)?this.quote.discount=0:""==this.quote.discount?(this.quote.discount=0,this.Calcul_Total()):this.Calcul_Total()},keyup_Shipping(){isNaN(this.quote.shipping)?this.quote.shipping=0:""==this.quote.shipping?(this.quote.shipping=0,this.Calcul_Total()):this.Calcul_Total()},formatNumber(t,e){const i=("string"===typeof t?t:t.toString()).split(".");if(e<=0)return i[0];let a=i[1]||"";if(a.length>e)return`${i[0]}.${a.substr(0,e)}`;while(a.length<e)a+="0";return`${i[0]}.${a}`},Calcul_Total(){this.total=0;for(var t=0;t<this.details.length;t++){var e=this.details[t].taxe*this.details[t].quantity;this.details[t].subtotal=parseFloat(this.details[t].quantity*this.details[t].Net_price+e),this.total=parseFloat(this.total+this.details[t].subtotal)}const i=parseFloat(this.total-this.quote.discount);this.quote.TaxNet=parseFloat(i*this.quote.tax_rate/100),this.GrandTotal=parseFloat(i+this.quote.TaxNet+this.quote.shipping);var a=this.GrandTotal.toFixed(2);this.GrandTotal=parseFloat(a)},delete_Product_Detail(t){for(var e=0;e<this.details.length;e++)t===this.details[e].detail_id&&(this.details.splice(e,1),this.Calcul_Total())},verifiedForm(){if(this.details.length<=0)return this.makeToast("warning",this.$t("AddProductToList"),this.$t("Warning")),!1;for(var t=0,e=0;e<this.details.length;e++)""!=this.details[e].quantity&&0!==this.details[e].quantity||(t+=1);return!(t>0)||(this.makeToast("warning",this.$t("AddQuantity"),this.$t("Warning")),!1)},Create_Quotation(){this.verifiedForm()&&(this.SubmitProcessing=!0,et().start(),et().set(.1),axios.post("quotations",{date:this.quote.date,client_id:this.quote.client_id,GrandTotal:this.GrandTotal,warehouse_id:this.quote.warehouse_id,statut:this.quote.statut,notes:this.quote.notes,tax_rate:this.quote.tax_rate?this.quote.tax_rate:0,TaxNet:this.quote.TaxNet?this.quote.TaxNet:0,Discount:this.quote.discount?this.quote.discount:0,shipping:this.quote.shipping?this.quote.shipping:0,details:this.details}).then((t=>{et().done(),this.makeToast("success",this.$t("Create.TitleQuote"),this.$t("Success")),this.SubmitProcessing=!1,this.$router.push({name:"index_quotation"})})).catch((t=>{et().done(),this.makeToast("danger",this.$t("InvalidData"),this.$t("Failed")),this.SubmitProcessing=!1})))},Last_Detail_id(){this.product.detail_id=0;var t=this.details.length;this.product.detail_id=this.details[t-1].detail_id+1},Get_Product_Details(t,e){axios.get("/show_product_data/"+t+"/"+e).then((t=>{this.product.discount=0,this.product.DiscountNet=0,this.product.discount_Method="2",this.product.product_id=t.data.id,this.product.product_type=t.data.product_type,this.product.name=t.data.name,this.product.Net_price=t.data.Net_price,this.product.Unit_price=t.data.Unit_price,this.product.fix_price=t.data.fix_price,this.product.taxe=t.data.tax_price,this.product.tax_method=t.data.tax_method,this.product.tax_percent=t.data.tax_percent,this.product.unitSale=t.data.unitSale,this.product.sale_unit_id=t.data.sale_unit_id,this.product.is_imei=t.data.is_imei,this.product.imei_number="",this.add_product(),this.Calcul_Total()}))},GetElements(){axios.get("quotations/create").then((t=>{this.clients=t.data.clients,this.warehouses=t.data.warehouses,this.quotation_with_stock=t.data.quotation_with_stock,this.isLoading=!1})).catch((t=>{setTimeout((()=>{this.isLoading=!1}),500)}))}},created(){this.GetElements()}};var at=i(66262);const st=(0,at.A)(it,[["render",H]]),lt=st}}]);
//# sourceMappingURL=store_quotation.a66a58cc.js.map