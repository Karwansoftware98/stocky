"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[7842],{55419:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var s=a(20641),l=a(90033);const r={class:"main-content"},o={key:0,class:"loading_page spinner spinner-primary mr-3"},i={key:2},n={slot:"table-actions",class:"mt-2 mb-3"},d=(0,s.Lk)("i",{class:"i-Filter-2"},null,-1),h=(0,s.Lk)("i",{class:"i-File-Copy"},null,-1),u=(0,s.Lk)("i",{class:"i-File-Excel"},null,-1),c={class:"px-3 py-2"},m=(0,s.Lk)("i",{class:"i-Filter-2"},null,-1),p=(0,s.Lk)("i",{class:"i-Power-2"},null,-1);function g(e,t,a,g,b,_){const f=(0,s.g2)("breadcumb"),C=(0,s.g2)("date-range-picker"),v=(0,s.g2)("b-col"),w=(0,s.g2)("b-button"),F=(0,s.g2)("vue-excel-xlsx"),P=(0,s.g2)("vue-good-table"),k=(0,s.g2)("v-select"),y=(0,s.g2)("b-form-group"),S=(0,s.g2)("b-row"),D=(0,s.g2)("b-sidebar"),R=(0,s.gN)("b-toggle");return(0,s.uX)(),(0,s.CE)("div",r,[(0,s.bF)(f,{page:e.$t("product_sales_report"),folder:e.$t("Reports")},null,8,["page","folder"]),b.isLoading?((0,s.uX)(),(0,s.CE)("div",o)):(0,s.Q3)("",!0),b.isLoading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(v,{key:1,md:"12",class:"text-center"},{default:(0,s.k6)((()=>[(0,s.bF)(C,{modelValue:b.dateRange,"onUpdate:modelValue":t[0]||(t[0]=e=>b.dateRange=e),startDate:b.startDate,endDate:b.endDate,onUpdate:_.Submit_filter_dateRange,"locale-data":b.locale},{input:(0,s.k6)((e=>[(0,s.eW)((0,l.v_)(e.startDate.toJSON().slice(0,10))+" - "+(0,l.v_)(e.endDate.toJSON().slice(0,10)),1)])),_:1},8,["modelValue","startDate","endDate","onUpdate","locale-data"])])),_:1})),b.isLoading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",i,[(0,s.bF)(P,{mode:"remote",columns:_.columns,totalRows:b.totalRows,rows:b.rows,onOnPageChange:_.onPageChange,onOnPerPageChange:_.onPerPageChange,onOnSortChange:_.onSortChange,onOnSearch:_.onSearch,"search-options":{placeholder:e.$t("Search_this_table"),enabled:!0},"group-options":{enabled:!0,headerPosition:"bottom"},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:b.showDropdown?"tableOne table-hover vgt-table full-height":"tableOne table-hover vgt-table non-height"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",n,[(0,s.bo)(((0,s.uX)(),(0,s.Wv)(w,{variant:"outline-info ripple m-1",size:"sm"},{default:(0,s.k6)((()=>[d,(0,s.eW)(" "+(0,l.v_)(e.$t("Filter")),1)])),_:1})),[[R,void 0,void 0,{"sidebar-right":!0}]]),(0,s.bF)(w,{onClick:t[1]||(t[1]=e=>_.Sales_PDF()),size:"sm",variant:"outline-success ripple m-1"},{default:(0,s.k6)((()=>[h,(0,s.eW)(" PDF ")])),_:1}),(0,s.bF)(F,{class:"btn btn-sm btn-outline-danger ripple m-1",data:b.sales,columns:_.columns,"file-name":"sales","file-type":"xlsx","sheet-name":"sales"},{default:(0,s.k6)((()=>[u,(0,s.eW)(" EXCEL ")])),_:1},8,["data","columns"])])])),_:1},8,["columns","totalRows","rows","onOnPageChange","onOnPerPageChange","onOnSortChange","onOnSearch","search-options","styleClass"])])),(0,s.bF)(D,{id:"sidebar-right",title:e.$t("Filter"),"bg-variant":"white",right:"",shadow:""},{default:(0,s.k6)((()=>[(0,s.Lk)("div",c,[(0,s.bF)(S,null,{default:(0,s.k6)((()=>[(0,s.bF)(v,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(y,{label:e.$t("Customer")},{default:(0,s.k6)((()=>[(0,s.bF)(k,{reduce:e=>e.value,placeholder:e.$t("Choose_Customer"),modelValue:b.Filter_Client,"onUpdate:modelValue":t[2]||(t[2]=e=>b.Filter_Client=e),options:b.customers.map((e=>({label:e.name,value:e.id})))},null,8,["reduce","placeholder","modelValue","options"])])),_:1},8,["label"])])),_:1}),(0,s.bF)(v,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(y,{label:e.$t("warehouse")},{default:(0,s.k6)((()=>[(0,s.bF)(k,{modelValue:b.Filter_warehouse,"onUpdate:modelValue":t[3]||(t[3]=e=>b.Filter_warehouse=e),reduce:e=>e.value,placeholder:e.$t("Choose_Warehouse"),options:b.warehouses.map((e=>({label:e.name,value:e.id})))},null,8,["modelValue","reduce","placeholder","options"])])),_:1},8,["label"])])),_:1}),(0,s.bF)(v,{md:"6",sm:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(w,{onClick:t[4]||(t[4]=e=>_.Get_Sales(b.serverParams.page)),variant:"primary btn-block ripple m-1",size:"sm"},{default:(0,s.k6)((()=>[m,(0,s.eW)(" "+(0,l.v_)(e.$t("Filter")),1)])),_:1})])),_:1}),(0,s.bF)(v,{md:"6",sm:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(w,{onClick:t[5]||(t[5]=e=>_.Reset_Filter()),variant:"danger ripple btn-block m-1",size:"sm"},{default:(0,s.k6)((()=>[p,(0,s.eW)(" "+(0,l.v_)(e.$t("Reset")),1)])),_:1})])),_:1})])),_:1})])])),_:1},8,["title"])])}var b=a(95353),_=a(5947),f=a.n(_),C=a(44323),v=(a(13246),a(32464)),w=a.n(v),F=a(95093),P=a.n(F);const k={metaInfo:{title:"Product Sales Report"},components:{DateRangePicker:w()},data(){return{startDate:"",endDate:"",dateRange:{startDate:"",endDate:""},locale:{Label:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:P().weekdaysMin(),monthNames:P().monthsShort(),firstDay:1},isLoading:!0,serverParams:{sort:{field:"id",type:"desc"},page:1,perPage:10},rows:[{statut:"Total",children:[]}],search:"",totalRows:"",showDropdown:!1,Filter_Client:"",Filter_warehouse:"",customers:[],warehouses:[],sales:[],limit:"10",today_mode:!0,to:"",from:""}},mounted(){this.$root.$on("bv::dropdown::show",(e=>{this.showDropdown=!0})),this.$root.$on("bv::dropdown::hide",(e=>{this.showDropdown=!1}))},computed:{...(0,b.L8)(["currentUserPermissions","currentUser"]),columns(){return[{label:this.$t("date"),field:"date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Reference"),field:"Ref",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Customer"),field:"client_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("warehouse"),field:"warehouse_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Name_product"),field:"product_name",tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Qty_sold"),field:"quantity",type:"decimal",headerField:this.sumCount,tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Total"),field:"total",type:"decimal",headerField:this.sumCount2,tdClass:"text-left",thClass:"text-left",sortable:!1}]}},methods:{sumCount(e){let t=0;for(let a=0;a<e.children.length;a++)t+=e.children[a].quantity;return t},sumCount2(e){let t=0;for(let a=0;a<e.children.length;a++)t+=e.children[a].total;return t},updateParams(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange({currentPage:e}){this.serverParams.page!==e&&(this.updateParams({page:e}),this.Get_Sales(e))},onPerPageChange({currentPerPage:e}){this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.Get_Sales(1))},onSortChange(e){let t="";t="client_name"==e[0].field?"client_id":"warehouse_name"==e[0].field?"warehouse_id":e[0].field,this.updateParams({sort:{type:e[0].type,field:t}}),this.Get_Sales(this.serverParams.page)},onSearch(e){this.search=e.searchTerm,this.Get_Sales(this.serverParams.page)},getValidationState({dirty:e,validated:t,valid:a=null}){return e||t?a:null},makeToast(e,t,a){this.$root.$bvToast.toast(t,{title:a,variant:e,solid:!0})},Reset_Filter(){this.search="",this.Filter_Client="",this.Filter_warehouse="",this.Get_Sales(this.serverParams.page)},formatNumber(e,t){const a=("string"===typeof e?e:e.toString()).split(".");if(t<=0)return a[0];let s=a[1]||"";if(s.length>t)return`${a[0]}.${s.substr(0,t)}`;while(s.length<t)s+="0";return`${a[0]}.${s}`},Sales_PDF(){var e=this;let t=new C["default"]("p","pt"),a=[{title:"date",dataKey:"date"},{title:"Ref",dataKey:"Ref"},{title:"Client",dataKey:"client_name"},{title:"Warehouse",dataKey:"warehouse_name"},{title:"Product",dataKey:"product_name"},{title:"Qty",dataKey:"quantity"},{title:"Total",dataKey:"total"}];t.autoTable(a,e.sales),t.text("Product Sales Report",40,25),t.save("Product_sales_report.pdf")},setToStrings(){null===this.Filter_Client?this.Filter_Client="":null===this.Filter_warehouse&&(this.Filter_warehouse="")},Submit_filter_dateRange(){var e=this;e.startDate=e.dateRange.startDate.toJSON().slice(0,10),e.endDate=e.dateRange.endDate.toJSON().slice(0,10),e.Get_Sales(1)},get_data_loaded(){var e=this;if(e.today_mode){let t=new Date;e.startDate=t.getFullYear(),e.endDate=(new Date).toJSON().slice(0,10),e.dateRange.startDate=t.getFullYear(),e.dateRange.endDate=(new Date).toJSON().slice(0,10)}},Get_Sales(e){f().start(),f().set(.1),this.setToStrings(),this.get_data_loaded(),axios.get("report/product_sales_report?page="+e+"&client_id="+this.Filter_Client+"&warehouse_id="+this.Filter_warehouse+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit+"&to="+this.endDate+"&from="+this.startDate).then((e=>{this.sales=e.data.sales,this.customers=e.data.customers,this.warehouses=e.data.warehouses,this.totalRows=e.data.totalRows,this.rows[0].children=this.sales,f().done(),this.isLoading=!1,this.today_mode=!1})).catch((e=>{f().done(),setTimeout((()=>{this.isLoading=!1,this.today_mode=!1}),500)}))}},created(){this.Get_Sales(1)}};var y=a(66262);const S=(0,y.A)(k,[["render",g]]),D=S}}]);
//# sourceMappingURL=product_sales_report.19d97330.js.map