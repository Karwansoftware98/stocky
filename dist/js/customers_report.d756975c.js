"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[8151],{60979:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var a=s(20641);const l={class:"main-content"},r={key:0,class:"loading_page spinner spinner-primary mr-3"},o={slot:"table-row","slot-scope":"props"},n={key:0},i=(0,a.Lk)("i",{class:"i-File-Copy text-25 text-success"},null,-1),h=[i],d=(0,a.Lk)("i",{class:"i-Eye text-25 text-info"},null,-1);function p(e,t,s,i,p,c){const u=(0,a.g2)("breadcumb"),m=(0,a.g2)("router-link"),g=(0,a.g2)("vue-good-table"),C=(0,a.g2)("b-card"),f=(0,a.gN)("b-tooltip");return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.bF)(u,{page:e.$t("CustomersReport"),folder:e.$t("Reports")},null,8,["page","folder"]),p.isLoading?((0,a.uX)(),(0,a.CE)("div",r)):(0,a.Q3)("",!0),p.isLoading?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(C,{key:1,class:"wrapper"},{default:(0,a.k6)((()=>[(0,a.bF)(g,{mode:"remote",columns:c.columns,totalRows:p.totalRows,rows:p.rows,"group-options":{enabled:!0,headerPosition:"bottom"},onOnPageChange:c.onPageChange,onOnPerPageChange:c.onPerPageChange,onOnSortChange:c.onSortChange,onOnSearch:c.onSearch,"search-options":{placeholder:e.$t("Search_this_table"),enabled:!0},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"tableOne table-hover vgt-table mt-3"},{default:(0,a.k6)((()=>[(0,a.Lk)("template",o,["actions"==e.props.column.field?((0,a.uX)(),(0,a.CE)("span",n,[(0,a.bo)(((0,a.uX)(),(0,a.CE)("a",{title:"PDF",class:"cursor-pointer",onClick:t[0]||(t[0]=t=>c.Download_PDF(e.props.row,e.props.row.id))},h)),[[f,void 0,void 0,{hover:!0}]]),(0,a.bF)(m,{title:"Report",to:"/app/reports/detail_customer/"+e.props.row.id},{default:(0,a.k6)((()=>[d])),_:1},8,["to"])])):(0,a.Q3)("",!0)])])),_:1},8,["columns","totalRows","rows","onOnPageChange","onOnPerPageChange","onOnSortChange","onOnSearch","search-options"])])),_:1}))])}var c=s(5947),u=s.n(c),m=s(95353);const g={metaInfo:{title:"Report Customers"},data(){return{isLoading:!0,serverParams:{sort:{field:"id",type:"desc"},page:1,perPage:10},limit:"10",search:"",totalRows:"",clients:[],client:{},rows:[{total_sales:"Total",children:[]}]}},computed:{...(0,m.L8)(["currentUser"]),columns(){return[{label:this.$t("CustomerName"),field:"name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Phone"),field:"phone",tdClass:"text-left",thClass:"text-left"},{label:this.$t("TotalSales"),field:"total_sales",tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Amount"),field:"total_amount",type:"decimal",headerField:this.sumCount,tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Paid"),field:"total_paid",type:"decimal",headerField:this.sumCount2,tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Total_Sale_Due"),field:"due",type:"decimal",headerField:this.sumCount3,tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Total_Sell_Return_Due"),field:"return_Due",type:"decimal",headerField:this.sumCount4,tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Action"),field:"actions",html:!0,tdClass:"text-right",thClass:"text-right",sortable:!1}]}},methods:{sumCount(e){let t=0;for(let s=0;s<e.children.length;s++)t+=e.children[s].total_amount;return t},sumCount2(e){let t=0;for(let s=0;s<e.children.length;s++)t+=e.children[s].total_paid;return t},sumCount3(e){let t=0;for(let s=0;s<e.children.length;s++)t+=e.children[s].due;return t},sumCount4(e){let t=0;for(let s=0;s<e.children.length;s++)t+=e.children[s].return_Due;return t},Download_PDF(e,t){u().start(),u().set(.1),axios.get("report/client_pdf/"+t,{responseType:"blob",headers:{"Content-Type":"application/json"}}).then((t=>{const s=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=s,a.setAttribute("download","report-"+e.name+".pdf"),document.body.appendChild(a),a.click(),setTimeout((()=>u().done()),500)})).catch((()=>{setTimeout((()=>u().done()),500)}))},updateParams(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange({currentPage:e}){this.serverParams.page!==e&&(this.updateParams({page:e}),this.Get_Client_Report(e))},onPerPageChange({currentPerPage:e}){this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.Get_Client_Report(1))},onSortChange(e){this.updateParams({sort:{type:e[0].type,field:e[0].field}}),this.Get_Client_Report(this.serverParams.page)},onSearch(e){this.search=e.searchTerm,this.Get_Client_Report(this.serverParams.page)},formatNumber(e,t){const s=("string"===typeof e?e:e.toString()).split(".");if(t<=0)return s[0];let a=s[1]||"";if(a.length>t)return`${s[0]}.${a.substr(0,t)}`;while(a.length<t)a+="0";return`${s[0]}.${a}`},Get_Client_Report(e){u().start(),u().set(.1),axios.get("report/client?page="+e+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit).then((e=>{this.clients=e.data.report,this.totalRows=e.data.totalRows,this.rows[0].children=this.clients,u().done(),this.isLoading=!1})).catch((e=>{u().done(),setTimeout((()=>{this.isLoading=!1}),500)}))}},created:function(){this.Get_Client_Report(1)}};var C=s(66262);const f=(0,C.A)(g,[["render",p]]),b=f}}]);
//# sourceMappingURL=customers_report.d756975c.js.map