"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[438],{32479:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S});var s=a(20641),n=a(90033),l=a(53751);const o={class:"main-content"},i={key:0,class:"loading_page spinner spinner-primary mr-3"},d={slot:"selected-row-actions"},c={slot:"table-actions",class:"mt-2 mb-3"},r=(0,s.Lk)("i",{class:"i-Add"},null,-1),u={slot:"table-row","slot-scope":"props"},m={key:0},h=(0,s.Lk)("i",{class:"i-Edit text-25 text-success"},null,-1),_=[h],p=(0,s.Lk)("i",{class:"i-Close-Window text-25 text-danger"},null,-1),b=[p],g=(0,s.Lk)("i",{class:"i-Yes me-2 font-weight-bold"},null,-1),y={key:0,class:"typo__p"},f=(0,s.Lk)("div",{class:"spinner sm spinner-primary mt-3"},null,-1),k=[f];function v(e,t,a,h,p,f){const v=(0,s.g2)("breadcumb"),$=(0,s.g2)("b-button"),C=(0,s.g2)("vue-good-table"),F=(0,s.g2)("b-card"),w=(0,s.g2)("v-select"),P=(0,s.g2)("b-form-invalid-feedback"),x=(0,s.g2)("b-form-group"),T=(0,s.g2)("validation-provider"),A=(0,s.g2)("b-col"),S=(0,s.g2)("Datepicker"),D=(0,s.g2)("vue-clock-picker"),E=(0,s.g2)("b-row"),V=(0,s.g2)("b-form"),I=(0,s.g2)("b-modal"),L=(0,s.g2)("validation-observer"),O=(0,s.gN)("b-tooltip");return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.bF)(v,{page:e.$t("Attendances"),folder:e.$t("hrm")},null,8,["page","folder"]),p.isLoading?((0,s.uX)(),(0,s.CE)("div",i)):(0,s.Q3)("",!0),p.isLoading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(F,{key:1,class:"wrapper"},{default:(0,s.k6)((()=>[(0,s.bF)(C,{mode:"remote",columns:f.columns,totalRows:p.totalRows,rows:p.attendances,onOnPageChange:f.onPageChange,onOnPerPageChange:f.onPerPageChange,onOnSortChange:f.onSortChange,onOnSearch:f.onSearch,"search-options":{enabled:!0,placeholder:e.$t("Search_this_table")},"select-options":{enabled:!0,clearSelectionText:""},onOnSelectedRowsChange:f.selectionChanged,"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"table-hover tableOne vgt-table"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",d,[(0,s.Lk)("button",{class:"btn btn-danger btn-sm",onClick:t[0]||(t[0]=e=>f.delete_by_selected())},(0,n.v_)(e.$t("Del")),1)]),(0,s.Lk)("div",c,[(0,s.bF)($,{onClick:t[1]||(t[1]=e=>f.New_attendance()),class:"btn-rounded",variant:"btn btn-primary btn-icon m-1"},{default:(0,s.k6)((()=>[r,(0,s.eW)(" "+(0,n.v_)(e.$t("Add")),1)])),_:1})]),(0,s.Lk)("template",u,["actions"==e.props.column.field?((0,s.uX)(),(0,s.CE)("span",m,[(0,s.bo)(((0,s.uX)(),(0,s.CE)("a",{onClick:t[2]||(t[2]=t=>f.Edit_Attendance(e.props.row)),class:"cursor-pointer",title:"Edit"},_)),[[O,void 0,void 0,{hover:!0}]]),(0,s.bo)(((0,s.uX)(),(0,s.CE)("a",{title:"Delete",class:"cursor-pointer",onClick:t[3]||(t[3]=t=>f.Remove_Attendance(e.props.row.id))},b)),[[O,void 0,void 0,{hover:!0}]])])):(0,s.Q3)("",!0)])])),_:1},8,["columns","totalRows","rows","onOnPageChange","onOnPerPageChange","onOnSortChange","onOnSearch","search-options","onOnSelectedRowsChange"])])),_:1})),(0,s.bF)(L,{ref:"Create_Attendance"},{default:(0,s.k6)((()=>[(0,s.bF)(I,{"hide-footer":"",size:"md",id:"Modal_attendance",title:p.editmode?e.$t("Edit"):e.$t("Add")},{default:(0,s.k6)((()=>[(0,s.bF)(V,{onSubmit:(0,l.D$)(f.Submit_Attendance,["prevent"])},{default:(0,s.k6)((()=>[(0,s.bF)(E,null,{default:(0,s.k6)((()=>[(0,s.bF)(A,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(T,{name:"Company",rules:{required:!0}},{default:(0,s.k6)((()=>[(0,s.bF)(x,{"slot-scope":"{ valid, errors }",label:e.$t("Company")+" *"},{default:(0,s.k6)((()=>[(0,s.bF)(w,{class:(0,n.C4)([{"is-invalid":!!e.errors.length},"required"]),state:!e.errors[0]&&(!!e.valid||null),modelValue:p.attendance.company_id,"onUpdate:modelValue":t[4]||(t[4]=e=>p.attendance.company_id=e),required:"",onInput:f.Selected_Company,placeholder:e.$t("Choose_Company"),reduce:e=>e.value,options:p.companies.map((e=>({label:e.name,value:e.id})))},null,8,["class","state","modelValue","onInput","placeholder","reduce","options"]),(0,s.bF)(P,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,s.bF)(A,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(T,{name:"Employee",rules:{required:!0}},{default:(0,s.k6)((()=>[(0,s.bF)(x,{"slot-scope":"{ valid, errors }",label:e.$t("Employee")+" *"},{default:(0,s.k6)((()=>[(0,s.bF)(w,{class:(0,n.C4)([{"is-invalid":!!e.errors.length},"required"]),state:!e.errors[0]&&(!!e.valid||null),modelValue:p.attendance.employee_id,"onUpdate:modelValue":t[5]||(t[5]=e=>p.attendance.employee_id=e),required:"",onInput:f.Selected_Employee,placeholder:e.$t("Choose_Employee"),reduce:e=>e.value,options:p.employees.map((e=>({label:e.username,value:e.id})))},null,8,["class","state","modelValue","onInput","placeholder","reduce","options"]),(0,s.bF)(P,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,s.bF)(A,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(T,{name:"Date",rules:{required:!0}},{default:(0,s.k6)((()=>[(0,s.bF)(x,{"slot-scope":"{ valid, errors }",label:e.$t("date")+" *"},{default:(0,s.k6)((()=>[(0,s.bF)(S,{id:"date",name:"date",placeholder:e.$t("Enter_Attendance_date"),modelValue:p.attendance.date,"onUpdate:modelValue":t[6]||(t[6]=e=>p.attendance.date=e),"input-class":"form-control back_important",format:"yyyy-MM-dd",onClosed:t[7]||(t[7]=e=>p.attendance.date=f.formatDate(p.attendance.date))},null,8,["placeholder","modelValue"]),(0,s.bF)(P,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,s.bF)(A,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(T,{name:"Time_In",rules:{required:!0}},{default:(0,s.k6)((()=>[(0,s.bF)(x,{"slot-scope":"{ valid, errors }",label:e.$t("Time_In")+" *"},{default:(0,s.k6)((()=>[(0,s.bF)(D,{modelValue:p.attendance.clock_in,"onUpdate:modelValue":t[8]||(t[8]=e=>p.attendance.clock_in=e),placeholder:e.$t("Time_In"),name:"clock_in",id:"clock_in"},null,8,["modelValue","placeholder"]),(0,s.bF)(P,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,s.bF)(A,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(T,{name:"Time_Out",rules:{required:!0}},{default:(0,s.k6)((()=>[(0,s.bF)(x,{"slot-scope":"{ valid, errors }",label:e.$t("Time_Out")+" *"},{default:(0,s.k6)((()=>[(0,s.bF)(D,{modelValue:p.attendance.clock_out,"onUpdate:modelValue":t[9]||(t[9]=e=>p.attendance.clock_out=e),placeholder:e.$t("Time_Out"),name:"clock_out",id:"clock_out"},null,8,["modelValue","placeholder"]),(0,s.bF)(P,null,{default:(0,s.k6)((()=>[(0,s.eW)((0,n.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,s.bF)(A,{md:"12",class:"mt-3"},{default:(0,s.k6)((()=>[(0,s.bF)($,{variant:"primary",type:"submit",disabled:p.SubmitProcessing},{default:(0,s.k6)((()=>[g,(0,s.eW)(" "+(0,n.v_)(e.$t("submit")),1)])),_:1},8,["disabled"]),t[10]||((0,s.Vq)(-1),t[10]=p.SubmitProcessing?((0,s.uX)(),(0,s.CE)("div",y,k)):(0,s.Q3)("",!0),(0,s.Vq)(1),t[10])])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1},8,["title"])])),_:1},512)])}var $=a(21227),C=a.n($),F=a(5947),w=a.n(F),P=a(56045);const x={metaInfo:{title:"Attendance"},data(){return{isLoading:!0,SubmitProcessing:!1,serverParams:{columnFilters:{},sort:{field:"id",type:"desc"},page:1,perPage:10},selectedIds:[],totalRows:"",search:"",limit:"10",editmode:!1,employees:[],companies:[],attendances:[],attendance:{company_id:"",employee_id:"",date:"",clock_in:"",clock_out:""},office_shift:{name:"",company_id:"",monday_in:"",monday_out:"",tuesday_in:"",tuesday_out:"",wednesday_in:"",wednesday_out:"",thursday_in:"",thursday_out:"",friday_in:"",friday_out:"",saturday_in:"",saturday_out:"",sunday_in:"",sunday_out:""}}},computed:{columns(){return[{label:this.$t("Employee"),field:"employee_username",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Company"),field:"company_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("date"),field:"date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Time_In"),field:"clock_in",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Time_Out"),field:"clock_out",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Work_Duration"),field:"total_work",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Action"),field:"actions",html:!0,tdClass:"text-right",thClass:"text-right",sortable:!1}]}},components:{VueClockPicker:C(),Datepicker:P.A},methods:{updateParams(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange({currentPage:e}){this.serverParams.page!==e&&(this.updateParams({page:e}),this.Get_Attendances(e))},onPerPageChange({currentPerPage:e}){this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.Get_Attendances(1))},selectionChanged({selectedRows:e}){this.selectedIds=[],e.forEach(((e,t)=>{this.selectedIds.push(e.id)}))},formatDate(e){var t=e.getMonth()+1,a=t<10?"0"+t:t,s=e.getDate(),n=s<10?"0"+s:s;return[e.getFullYear(),a,n].join("-")},onSortChange(e){let t="";t="company_name"==e[0].field?"company_id":"employee_username"==e[0].field?"employee_id":e[0].field,this.updateParams({sort:{type:e[0].type,field:e[0].field}}),this.Get_Attendances(this.serverParams.page)},onSearch(e){this.search=e.searchTerm,this.Get_Attendances(this.serverParams.page)},getValidationState({dirty:e,validated:t,valid:a=null}){return e||t?a:null},Submit_Attendance(){this.$refs.Create_Attendance.validate().then((e=>{e?this.editmode?this.Update_Attendance():this.Create_Attendance():this.makeToast("danger",this.$t("Please_fill_the_form_correctly"),this.$t("Failed"))}))},makeToast(e,t,a){this.$root.$bvToast.toast(t,{title:a,variant:e,solid:!0})},New_attendance(){this.reset_Form(),this.editmode=!1,this.Get_all_companies(),this.$bvModal.show("Modal_attendance")},Edit_Attendance(e){this.editmode=!0,this.reset_Form(),this.Get_all_companies(),this.Get_employees_by_company(e.company_id),this.attendance=e,this.$bvModal.show("Modal_attendance")},Selected_Company(e){null===e&&(this.attendance.company_id=""),this.employees=[],this.attendance.employee_id="",this.Get_employees_by_company(e)},Selected_Employee(e){null===e&&(this.attendance.employee_id="")},Get_employees_by_company(e){axios.get("/core/get_employees_by_company?id="+e).then((({data:e})=>this.employees=e))},Get_all_companies(){axios.get("/attendances/create").then((e=>{this.companies=e.data.companies})).catch((e=>{}))},Get_Attendances(e){w().start(),w().set(.1),axios.get("attendances?page="+e+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit).then((e=>{this.totalRows=e.data.totalRows,this.attendances=e.data.attendances,w().done(),this.isLoading=!1})).catch((e=>{w().done(),setTimeout((()=>{this.isLoading=!1}),500)}))},Create_Attendance(){this.SubmitProcessing=!0,axios.post("attendances",{company_id:this.attendance.company_id,employee_id:this.attendance.employee_id,date:this.attendance.date,clock_in:this.attendance.clock_in,clock_out:this.attendance.clock_out}).then((e=>{this.SubmitProcessing=!1,Fire.$emit("Event_Attendance"),this.makeToast("success",this.$t("Created_in_successfully"),this.$t("Success"))})).catch((e=>{this.SubmitProcessing=!1,this.makeToast("danger",this.$t("InvalidData"),this.$t("Failed"))}))},Update_Attendance(){this.SubmitProcessing=!0,axios.put("attendances/"+this.attendance.id,{company_id:this.attendance.company_id,employee_id:this.attendance.employee_id,date:this.attendance.date,clock_in:this.attendance.clock_in,clock_out:this.attendance.clock_out}).then((e=>{this.SubmitProcessing=!1,Fire.$emit("Event_Attendance"),this.makeToast("success",this.$t("Updated_in_successfully"),this.$t("Success"))})).catch((e=>{this.SubmitProcessing=!1,this.makeToast("danger",this.$t("InvalidData"),this.$t("Failed"))}))},reset_Form(){this.attendance={company_id:"",employee_id:"",date:"",clock_in:"",clock_out:""}},Remove_Attendance(e){this.$swal({title:this.$t("Delete.Title"),text:this.$t("Delete.Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete.cancelButtonText"),confirmButtonText:this.$t("Delete.confirmButtonText")}).then((t=>{t.value&&axios.delete("attendances/"+e).then((()=>{this.$swal(this.$t("Delete.Deleted"),this.$t("Deleted_in_successfully"),"success"),Fire.$emit("Delete_Attendance")})).catch((()=>{this.$swal(this.$t("Delete.Failed"),this.$t("Delete.Therewassomethingwronge"),"warning")}))}))},delete_by_selected(){this.$swal({title:this.$t("Delete.Title"),text:this.$t("Delete.Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete.cancelButtonText"),confirmButtonText:this.$t("Delete.confirmButtonText")}).then((e=>{e.value&&(w().start(),w().set(.1),axios.post("attendances/delete/by_selection",{selectedIds:this.selectedIds}).then((()=>{this.$swal(this.$t("Delete.Deleted"),this.$t("Deleted_in_successfully"),"success"),Fire.$emit("Delete_Attendance")})).catch((()=>{setTimeout((()=>w().done()),500),this.$swal(this.$t("Delete.Failed"),this.$t("Delete.Therewassomethingwronge"),"warning")})))}))}},created:function(){this.Get_Attendances(1),Fire.$on("Event_Attendance",(()=>{setTimeout((()=>{this.Get_Attendances(this.serverParams.page),this.$bvModal.hide("Modal_attendance")}),500)})),Fire.$on("Delete_Attendance",(()=>{setTimeout((()=>{this.Get_Attendances(this.serverParams.page)}),500)}))}};var T=a(66262);const A=(0,T.A)(x,[["render",v]]),S=A}}]);
//# sourceMappingURL=attendance.df06a3a6.js.map