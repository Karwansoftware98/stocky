"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[427],{30427:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});var a=s(20641),l=s(90033);const o={class:"main-content"},i={key:0,class:"loading_page spinner spinner-primary mr-3"},n={key:1},r={slot:"selected-row-actions"},d={slot:"table-actions",class:"mt-2 mb-3"},u=(0,a.Lk)("i",{class:"i-Filter-2"},null,-1),c=(0,a.Lk)("i",{class:"i-File-Copy"},null,-1),h=(0,a.Lk)("i",{class:"i-File-Excel"},null,-1),m=(0,a.Lk)("span",{class:"ul-btn__icon"},[(0,a.Lk)("i",{class:"i-Add"})],-1),p={class:"ul-btn__text ml-1"},_={slot:"table-row","slot-scope":"props"},b={key:0},f=(0,a.Lk)("span",{class:"_dot _r_block-dot bg-dark"},null,-1),g=(0,a.Lk)("span",{class:"_dot _r_block-dot bg-dark"},null,-1),k=(0,a.Lk)("span",{class:"_dot _r_block-dot bg-dark"},null,-1),w=(0,a.Lk)("i",{class:"nav-icon i-Eye font-weight-bold mr-2"},null,-1),v=(0,a.Lk)("i",{class:"nav-icon i-Pen-2 font-weight-bold mr-2"},null,-1),F=(0,a.Lk)("i",{class:"nav-icon i-Add font-weight-bold mr-2"},null,-1),$=(0,a.Lk)("i",{class:"nav-icon i-File-TXT font-weight-bold mr-2"},null,-1),C=(0,a.Lk)("i",{class:"nav-icon i-Envelope-2 font-weight-bold mr-2"},null,-1),P=(0,a.Lk)("i",{class:"nav-icon i-Speach-Bubble font-weight-bold mr-2"},null,-1),x=(0,a.Lk)("i",{class:"nav-icon i-Close-Window font-weight-bold mr-2"},null,-1),T={key:1},y={key:0,class:"badge badge-outline-success"},S={key:1,class:"badge badge-outline-info"},Q={key:2},L={class:"ul-btn__text ml-1"},D={class:"px-3 py-2"},R=(0,a.Lk)("i",{class:"i-Filter-2"},null,-1),q=(0,a.Lk)("i",{class:"i-Power-2"},null,-1);function E(e,t,s,E,W,B){const V=(0,a.g2)("breadcumb"),X=(0,a.g2)("b-button"),O=(0,a.g2)("vue-excel-xlsx"),U=(0,a.g2)("router-link"),G=(0,a.g2)("b-dropdown-item"),I=(0,a.g2)("b-navbar-nav"),A=(0,a.g2)("b-dropdown"),K=(0,a.g2)("vue-good-table"),z=(0,a.g2)("b-form-input"),M=(0,a.g2)("b-form-group"),j=(0,a.g2)("b-col"),N=(0,a.g2)("v-select"),H=(0,a.g2)("b-row"),J=(0,a.g2)("b-sidebar"),Y=(0,a.gN)("b-toggle");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(V,{page:e.$t("ListQuotations"),folder:e.$t("Quotations")},null,8,["page","folder"]),W.isLoading?((0,a.uX)(),(0,a.CE)("div",i)):((0,a.uX)(),(0,a.CE)("div",n,[(0,a.bF)(K,{mode:"remote",columns:B.columns,totalRows:W.totalRows,rows:W.quotations,onOnPageChange:B.onPageChange,onOnPerPageChange:B.onPerPageChange,onOnSortChange:B.onSortChange,onOnSearch:B.onSearch,"search-options":{enabled:!0,placeholder:e.$t("Search_this_table")},"select-options":{enabled:!0,clearSelectionText:""},onOnSelectedRowsChange:B.selectionChanged,"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:W.showDropdown?"tableOne table-hover vgt-table full-height":"tableOne table-hover vgt-table non-height"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",r,[(0,a.Lk)("button",{class:"btn btn-danger btn-sm",onClick:t[0]||(t[0]=e=>B.delete_by_selected())},(0,l.v_)(e.$t("Del")),1)]),(0,a.Lk)("div",d,[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(X,{variant:"outline-info ripple m-1",size:"sm"},{default:(0,a.k6)((()=>[u,(0,a.eW)(" "+(0,l.v_)(e.$t("Filter")),1)])),_:1})),[[Y,void 0,void 0,{"sidebar-right":!0}]]),(0,a.bF)(X,{onClick:t[1]||(t[1]=e=>B.Quotation_PDF()),size:"sm",variant:"outline-success ripple m-1"},{default:(0,a.k6)((()=>[c,(0,a.eW)(" PDF ")])),_:1}),(0,a.bF)(O,{class:"btn btn-sm btn-outline-danger ripple m-1",data:W.quotations,columns:B.columns,"file-name":"quotations","file-type":"xlsx","sheet-name":"quotations"},{default:(0,a.k6)((()=>[h,(0,a.eW)(" EXCEL ")])),_:1},8,["data","columns"]),e.currentUserPermissions&&e.currentUserPermissions.includes("Quotations_add")?((0,a.uX)(),(0,a.Wv)(U,{key:0,class:"btn-sm btn btn-primary ripple btn-icon m-1",to:"/app/quotations/store"},{default:(0,a.k6)((()=>[m,(0,a.Lk)("span",p,(0,l.v_)(e.$t("Add")),1)])),_:1})):(0,a.Q3)("",!0)]),(0,a.Lk)("template",_,["actions"==e.props.column.field?((0,a.uX)(),(0,a.CE)("span",b,[(0,a.Lk)("div",null,[(0,a.bF)(A,{id:"dropdown-left",variant:"link",text:"Left align","toggle-class":"text-decoration-none",size:"lg","no-caret":""},{"button-content":(0,a.k6)((()=>[f,g,k])),default:(0,a.k6)((()=>[(0,a.bF)(I,null,{default:(0,a.k6)((()=>[(0,a.bF)(G,{title:"Show",to:"/app/quotations/detail/"+e.props.row.id},{default:(0,a.k6)((()=>[w,(0,a.eW)(" "+(0,l.v_)(e.$t("DetailQuote")),1)])),_:1},8,["to"])])),_:1}),e.currentUserPermissions.includes("Quotations_edit")?((0,a.uX)(),(0,a.Wv)(G,{key:0,title:"Edit",to:"/app/quotations/edit/"+e.props.row.id},{default:(0,a.k6)((()=>[v,(0,a.eW)(" "+(0,l.v_)(e.$t("EditQuote")),1)])),_:1},8,["to"])):(0,a.Q3)("",!0),e.currentUserPermissions.includes("Quotations_edit")?((0,a.uX)(),(0,a.Wv)(G,{key:1,title:"Create Sale",to:"/app/quotations/Create_sale/"+e.props.row.id},{default:(0,a.k6)((()=>[F,(0,a.eW)(" "+(0,l.v_)(e.$t("CreateSale")),1)])),_:1},8,["to"])):(0,a.Q3)("",!0),(0,a.bF)(G,{title:"PDF",onClick:t[2]||(t[2]=t=>B.Quote_pdf(e.props.row,e.props.row.id))},{default:(0,a.k6)((()=>[$,(0,a.eW)(" "+(0,l.v_)(e.$t("DownloadPdf")),1)])),_:1}),(0,a.bF)(G,{title:"Email",onClick:t[3]||(t[3]=t=>B.SendEmail(e.props.row.id))},{default:(0,a.k6)((()=>[C,(0,a.eW)(" "+(0,l.v_)(e.$t("email_notification")),1)])),_:1}),(0,a.bF)(G,{title:"SMS",onClick:t[4]||(t[4]=t=>B.Quote_SMS(e.props.row.id))},{default:(0,a.k6)((()=>[P,(0,a.eW)(" "+(0,l.v_)(e.$t("sms_notification")),1)])),_:1}),e.currentUserPermissions.includes("Quotations_delete")?((0,a.uX)(),(0,a.Wv)(G,{key:2,title:"Delete",onClick:t[5]||(t[5]=t=>B.Remove_Quotation(e.props.row.id))},{default:(0,a.k6)((()=>[x,(0,a.eW)(" "+(0,l.v_)(e.$t("DeleteQuote")),1)])),_:1})):(0,a.Q3)("",!0)])),_:1})])])):"statut"==e.props.column.field?((0,a.uX)(),(0,a.CE)("div",T,["sent"==e.props.row.statut?((0,a.uX)(),(0,a.CE)("span",y,(0,l.v_)(e.$t("Sent")),1)):((0,a.uX)(),(0,a.CE)("span",S,(0,l.v_)(e.$t("Pending")),1))])):"Ref"==e.props.column.field?((0,a.uX)(),(0,a.CE)("div",Q,[(0,a.bF)(U,{to:"/app/quotations/detail/"+e.props.row.id},{default:(0,a.k6)((()=>[(0,a.Lk)("span",L,(0,l.v_)(e.props.row.Ref),1)])),_:1},8,["to"])])):(0,a.Q3)("",!0)])])),_:1},8,["columns","totalRows","rows","onOnPageChange","onOnPerPageChange","onOnSortChange","onOnSearch","search-options","onOnSelectedRowsChange","styleClass"])])),(0,a.bF)(J,{id:"sidebar-right",title:e.$t("Filter"),"bg-variant":"white",right:"",shadow:""},{default:(0,a.k6)((()=>[(0,a.Lk)("div",D,[(0,a.bF)(H,null,{default:(0,a.k6)((()=>[(0,a.bF)(j,{md:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(M,{label:e.$t("date")},{default:(0,a.k6)((()=>[(0,a.bF)(z,{type:"date",modelValue:W.Filter_date,"onUpdate:modelValue":t[6]||(t[6]=e=>W.Filter_date=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,a.bF)(j,{md:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(M,{label:e.$t("Reference")},{default:(0,a.k6)((()=>[(0,a.bF)(z,{label:"Reference",placeholder:e.$t("Reference"),modelValue:W.Filter_Ref,"onUpdate:modelValue":t[7]||(t[7]=e=>W.Filter_Ref=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"])])),_:1}),(0,a.bF)(j,{md:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(M,{label:e.$t("Customer")},{default:(0,a.k6)((()=>[(0,a.bF)(N,{reduce:e=>e.value,placeholder:e.$t("Choose_Customer"),modelValue:W.Filter_client,"onUpdate:modelValue":t[8]||(t[8]=e=>W.Filter_client=e),options:W.customers.map((e=>({label:e.name,value:e.id})))},null,8,["reduce","placeholder","modelValue","options"])])),_:1},8,["label"])])),_:1}),(0,a.bF)(j,{md:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(M,{label:e.$t("warehouse")},{default:(0,a.k6)((()=>[(0,a.bF)(N,{modelValue:W.Filter_warehouse,"onUpdate:modelValue":t[9]||(t[9]=e=>W.Filter_warehouse=e),reduce:e=>e.value,placeholder:e.$t("Choose_Warehouse"),options:W.warehouses.map((e=>({label:e.name,value:e.id})))},null,8,["modelValue","reduce","placeholder","options"])])),_:1},8,["label"])])),_:1}),(0,a.bF)(j,{md:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(M,{label:e.$t("Status")},{default:(0,a.k6)((()=>[(0,a.bF)(N,{modelValue:W.Filter_status,"onUpdate:modelValue":t[10]||(t[10]=e=>W.Filter_status=e),reduce:e=>e.value,placeholder:e.$t("Choose_Status"),options:[{label:"Sent",value:"sent"},{label:"Pending",value:"pending"}]},null,8,["modelValue","reduce","placeholder"])])),_:1},8,["label"])])),_:1}),(0,a.bF)(j,{md:"6",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(X,{onClick:t[11]||(t[11]=e=>B.Get_Quotations(W.serverParams.page)),variant:"primary ripple m-1",size:"sm",block:""},{default:(0,a.k6)((()=>[R,(0,a.eW)(" "+(0,l.v_)(e.$t("Filter")),1)])),_:1})])),_:1}),(0,a.bF)(j,{md:"6",sm:"12"},{default:(0,a.k6)((()=>[(0,a.bF)(X,{onClick:t[12]||(t[12]=e=>B.Reset_Filter()),variant:"danger ripple m-1",size:"sm",block:""},{default:(0,a.k6)((()=>[q,(0,a.eW)(" "+(0,l.v_)(e.$t("Reset")),1)])),_:1})])),_:1})])),_:1})])])),_:1},8,["title"])])}var W=s(95353),B=s(5947),V=s.n(B),X=s(44323);s(13246);const O={metaInfo:{title:"Quotation"},data(){return{isLoading:!0,serverParams:{sort:{field:"id",type:"desc"},page:1,perPage:10},selectedIds:[],totalRows:"",search:"",showDropdown:!1,Filter_date:"",Filter_client:"",Filter_status:"",Filter_Ref:"",Filter_warehouse:"",customers:[],warehouses:[],details:[],quotations:[],quote:{},limit:"10",email:{to:"",subject:"",message:"",client_name:"",quote_Ref:""}}},mounted:function(){this.$root.$on("bv::dropdown::show",(e=>{this.showDropdown=!0})),this.$root.$on("bv::dropdown::hide",(e=>{this.showDropdown=!1}))},computed:{...(0,W.L8)(["currentUserPermissions","currentUser"]),columns(){return[{label:this.$t("date"),field:"date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Reference"),field:"Ref",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Customer"),field:"client_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("warehouse"),field:"warehouse_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Status"),field:"statut",html:!0,tdClass:"text-left",thClass:"text-left"},{label:this.$t("Total"),field:"GrandTotal",type:"decimal",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Action"),field:"actions",html:!0,tdClass:"text-right",thClass:"text-right",sortable:!1}]}},methods:{updateParams(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange({currentPage:e}){this.serverParams.page!==e&&(this.updateParams({page:e}),this.Get_Quotations(e))},onPerPageChange({currentPerPage:e}){this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.Get_Quotations(1))},selectionChanged({selectedRows:e}){this.selectedIds=[],e.forEach(((e,t)=>{this.selectedIds.push(e.id)}))},onSortChange(e){let t="";t="client_name"==e[0].field?"client_id":"warehouse_name"==e[0].field?"warehouse_id":e[0].field,this.updateParams({sort:{type:e[0].type,field:t}}),this.Get_Quotations(this.serverParams.page)},onSearch(e){this.search=e.searchTerm,this.Get_Quotations(this.serverParams.page)},makeToast(e,t,s){this.$root.$bvToast.toast(t,{title:s,variant:e,solid:!0})},Reset_Filter(){this.search="",this.Filter_date="",this.Filter_client="",this.Filter_status="",this.Filter_Ref="",this.Filter_warehouse="",this.Get_Quotations(this.serverParams.page)},Quotation_PDF(){var e=this;let t=new X["default"]("p","pt"),s=[{title:"Date",dataKey:"date"},{title:"Ref",dataKey:"Ref"},{title:"Client",dataKey:"client_name"},{title:"Warehouse",dataKey:"warehouse_name"},{title:"Status",dataKey:"statut"},{title:"Total",dataKey:"GrandTotal"}];t.autoTable(s,e.quotations),t.text("Quotation List",40,25),t.save("Quotation_List.pdf")},Quote_pdf(e,t){V().start(),V().set(.1),axios.get("quote_pdf/"+t,{responseType:"blob",headers:{"Content-Type":"application/json"}}).then((t=>{const s=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=s,a.setAttribute("download","Quotation_"+e.Ref+".pdf"),document.body.appendChild(a),a.click(),setTimeout((()=>V().done()),500)})).catch((()=>{setTimeout((()=>V().done()),500)}))},SendEmail(e){V().start(),V().set(.1),axios.post("quotations_send_email",{id:e}).then((e=>{setTimeout((()=>V().done()),500),this.makeToast("success",this.$t("Send.TitleEmail"),this.$t("Success"))})).catch((e=>{setTimeout((()=>V().done()),500),this.makeToast("danger",this.$t("SMTPIncorrect"),this.$t("Failed"))}))},Quote_SMS(e){V().start(),V().set(.1),axios.post("quotations_send_sms",{id:e}).then((e=>{setTimeout((()=>V().done()),500),this.makeToast("success",this.$t("Send_SMS"),this.$t("Success"))})).catch((e=>{setTimeout((()=>V().done()),500),this.makeToast("danger",this.$t("sms_config_invalid"),this.$t("Failed"))}))},setToStrings(){null===this.Filter_client?this.Filter_client="":null===this.Filter_warehouse?this.Filter_warehouse="":null===this.Filter_status&&(this.Filter_status="")},Get_Quotations(e){V().start(),V().set(.1),this.setToStrings(),axios.get("quotations?page="+this.serverParams.page+"&Ref="+this.Filter_Ref+"&client_id="+this.Filter_client+"&statut="+this.Filter_status+"&warehouse_id="+this.Filter_warehouse+"&date="+this.Filter_date+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit).then((e=>{this.quotations=e.data.quotations,this.customers=e.data.customers,this.warehouses=e.data.warehouses,this.totalRows=e.data.totalRows,V().done(),this.isLoading=!1})).catch((e=>{V().done(),setTimeout((()=>{this.isLoading=!1}),500)}))},Remove_Quotation(e){this.$swal({title:this.$t("Delete.Title"),text:this.$t("Delete.Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete.cancelButtonText"),confirmButtonText:this.$t("Delete.confirmButtonText")}).then((t=>{t.value&&(V().start(),V().set(.1),axios.delete("quotations/"+e).then((()=>{this.$swal(this.$t("Delete.Deleted"),this.$t("Delete.QuoteDeleted"),"success"),Fire.$emit("Delete_Quote")})).catch((()=>{setTimeout((()=>V().done()),500),this.$swal(this.$t("Delete.Failed"),this.$t("Delete.Therewassomethingwronge"),"warning")})))}))},delete_by_selected(){this.$swal({title:this.$t("Delete.Title"),text:this.$t("Delete.Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete.cancelButtonText"),confirmButtonText:this.$t("Delete.confirmButtonText")}).then((e=>{e.value&&(V().start(),V().set(.1),axios.post("quotations_delete_by_selection",{selectedIds:this.selectedIds}).then((()=>{this.$swal(this.$t("Delete.Deleted"),this.$t("Delete.QuoteDeleted"),"success"),Fire.$emit("Delete_Quote")})).catch((()=>{setTimeout((()=>V().done()),500),this.$swal(this.$t("Delete.Failed"),this.$t("Delete.Therewassomethingwronge"),"warning")})))}))}},created:function(){this.Get_Quotations(1),Fire.$on("Delete_Quote",(()=>{setTimeout((()=>{this.Get_Quotations(this.serverParams.page),setTimeout((()=>V().done()),500)}),500)}))}};var U=s(66262);const G=(0,U.A)(O,[["render",E]]),I=G}}]);
//# sourceMappingURL=427.0542f6ca.js.map