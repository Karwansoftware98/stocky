"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[6888],{19004:(t,e,a)=>{a.r(e),a.d(e,{default:()=>Y});var l=a(20641),s=a(53751),r=a(90033);const i={class:"main-content"},n={key:0,class:"loading_page spinner spinner-primary mr-3"},u={class:"alert alert-danger"},d={class:"table-responsive"},o={class:"table table-hover"},_={class:"bg-gray-300"},c=(0,l.Lk)("th",{scope:"col"},"#",-1),h={scope:"col"},b={scope:"col"},p={scope:"col"},m={scope:"col"},k={scope:"col"},g={scope:"col"},f={scope:"col"},v={key:0},y={colspan:"9"},F=(0,l.Lk)("br",null,null,-1),L={class:"badge badge-success"},$={class:"badge badge-outline-warning"},T={class:"quantity"},x=["onClick"],S=["onKeyup","onUpdate:modelValue"],q=["onClick"],C={class:"offset-md-9 col-md-3 mt-4"},V={class:"table table-striped table-sm"},N={class:"bold"},U={class:"bold"},w={class:"bold"},D={class:"font-weight-bold"},P={class:"font-weight-bold"},W=["placeholder"],O=(0,l.Lk)("i",{class:"i-Yes me-2 font-weight-bold"},null,-1),G={key:0,class:"typo__p"},E=(0,l.Lk)("div",{class:"spinner sm spinner-primary mt-3"},null,-1),Q=[E];function X(t,e,a,E,X,K){const I=(0,l.g2)("breadcumb"),R=(0,l.g2)("b-form-input"),A=(0,l.g2)("b-form-invalid-feedback"),M=(0,l.g2)("b-form-group"),J=(0,l.g2)("validation-provider"),Y=(0,l.g2)("b-col"),j=(0,l.g2)("v-select"),z=(0,l.g2)("b-input-group-prepend"),B=(0,l.g2)("b-input-group-append"),H=(0,l.g2)("b-input-group"),Z=(0,l.g2)("b-button"),tt=(0,l.g2)("b-row"),et=(0,l.g2)("b-card"),at=(0,l.g2)("b-form"),lt=(0,l.g2)("validation-observer");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.bF)(I,{page:t.$t("CreateSaleReturn"),folder:t.$t("ListReturns")},null,8,["page","folder"]),X.isLoading?((0,l.uX)(),(0,l.CE)("div",n)):(0,l.Q3)("",!0),X.isLoading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(lt,{key:1,ref:"create_sale_return"},{default:(0,l.k6)((()=>[(0,l.bF)(at,{onSubmit:(0,s.D$)(K.Submit_sale_return,["prevent"])},{default:(0,l.k6)((()=>[(0,l.bF)(tt,null,{default:(0,l.k6)((()=>[(0,l.bF)(Y,{lg:"12",md:"12",sm:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(et,null,{default:(0,l.k6)((()=>[(0,l.bF)(tt,null,{default:(0,l.k6)((()=>[(0,l.bF)(Y,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{name:"date",rules:{required:!0}},{default:(0,l.k6)((a=>[(0,l.bF)(M,{label:t.$t("date")+" *"},{default:(0,l.k6)((()=>[(0,l.bF)(R,{state:K.getValidationState(a),"aria-describedby":"date-feedback",type:"date",modelValue:X.sale_return.date,"onUpdate:modelValue":e[0]||(e[0]=t=>X.sale_return.date=t)},null,8,["state","modelValue"]),(0,l.bF)(A,{id:"OrderTax-feedback"},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,l.bF)(Y,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,l.k6)((()=>[(0,l.bF)(M,{label:t.$t("Sale")},{default:(0,l.k6)((()=>[(0,l.bF)(R,{label:"Sale",modelValue:X.sale_return.sale_ref,"onUpdate:modelValue":e[1]||(e[1]=t=>X.sale_return.sale_ref=t),disabled:"disabled"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.bF)(Y,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{name:"Status",rules:{required:!0}},{default:(0,l.k6)((()=>[(0,l.bF)(M,{"slot-scope":"{ valid, errors }",label:t.$t("Status")+" *"},{default:(0,l.k6)((()=>[(0,l.bF)(j,{class:(0,r.C4)({"is-invalid":!!t.errors.length}),state:!t.errors[0]&&(!!t.valid||null),modelValue:X.sale_return.statut,"onUpdate:modelValue":e[2]||(e[2]=t=>X.sale_return.statut=t),reduce:t=>t.value,placeholder:t.$t("Choose_Status"),options:[{label:"Received",value:"received"},{label:"Pending",value:"pending"}]},null,8,["class","state","modelValue","reduce","placeholder"]),(0,l.bF)(A,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(t.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,l.bF)(Y,{md:"12"},{default:(0,l.k6)((()=>[(0,l.Lk)("h5",null,(0,r.v_)(t.$t("list_product_returns"))+" *",1),(0,l.Lk)("div",u,(0,r.v_)(t.$t("products_refunded_alert")),1),(0,l.Lk)("div",d,[(0,l.Lk)("table",o,[(0,l.Lk)("thead",_,[(0,l.Lk)("tr",null,[c,(0,l.Lk)("th",h,(0,r.v_)(t.$t("ProductName")),1),(0,l.Lk)("th",b,(0,r.v_)(t.$t("Net_Unit_Price")),1),(0,l.Lk)("th",p,(0,r.v_)(t.$t("Quantity_sold")),1),(0,l.Lk)("th",m,(0,r.v_)(t.$t("Qty_return")),1),(0,l.Lk)("th",k,(0,r.v_)(t.$t("Discount")),1),(0,l.Lk)("th",g,(0,r.v_)(t.$t("Tax")),1),(0,l.Lk)("th",f,(0,r.v_)(t.$t("SubTotal")),1)])]),(0,l.Lk)("tbody",null,[X.details.length<=0?((0,l.uX)(),(0,l.CE)("tr",v,[(0,l.Lk)("td",y,(0,r.v_)(t.$t("NodataAvailable")),1)])):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(X.details,(e=>((0,l.uX)(),(0,l.CE)("tr",null,[(0,l.Lk)("td",null,(0,r.v_)(e.detail_id),1),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,r.v_)(e.code),1),F,(0,l.Lk)("span",L,(0,r.v_)(e.name),1)]),(0,l.Lk)("td",null,(0,r.v_)(t.currentUser.currency)+" "+(0,r.v_)(K.formatNumber(e.Net_price,3)),1),(0,l.Lk)("td",null,[(0,l.Lk)("span",$,(0,r.v_)(e.sale_quantity)+" "+(0,r.v_)(e.unitSale),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("div",T,[(0,l.bF)(H,null,{default:(0,l.k6)((()=>[(0,l.bF)(z,null,{default:(0,l.k6)((()=>[(0,l.Lk)("span",{class:"btn btn-primary btn-sm",onClick:t=>K.decrement(e,e.detail_id)},"-",8,x)])),_:2},1024),(0,l.bo)((0,l.Lk)("input",{class:"form-control",onKeyup:t=>K.Verified_Qty(e,e.detail_id),min:0,"onUpdate:modelValue":t=>e.quantity=t},null,40,S),[[s.Jo,e.quantity,void 0,{number:!0}]]),(0,l.bF)(B,null,{default:(0,l.k6)((()=>[(0,l.Lk)("span",{class:"btn btn-primary btn-sm",onClick:t=>K.increment(e,e.detail_id)},"+",8,q)])),_:2},1024)])),_:2},1024)])]),(0,l.Lk)("td",null,(0,r.v_)(t.currentUser.currency)+" "+(0,r.v_)(K.formatNumber(e.DiscountNet*e.quantity,2)),1),(0,l.Lk)("td",null,(0,r.v_)(t.currentUser.currency)+" "+(0,r.v_)(K.formatNumber(e.taxe*e.quantity,2)),1),(0,l.Lk)("td",null,(0,r.v_)(t.currentUser.currency)+" "+(0,r.v_)(e.subtotal.toFixed(2)),1)])))),256))])])])])),_:1}),(0,l.Lk)("div",C,[(0,l.Lk)("table",V,[(0,l.Lk)("tbody",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("td",N,(0,r.v_)(t.$t("OrderTax")),1),(0,l.Lk)("td",null,[(0,l.Lk)("span",null,(0,r.v_)(t.currentUser.currency)+" "+(0,r.v_)(X.sale_return.TaxNet.toFixed(2))+" ("+(0,r.v_)(K.formatNumber(X.sale_return.tax_rate,2))+" %)",1)])]),(0,l.Lk)("tr",null,[(0,l.Lk)("td",U,(0,r.v_)(t.$t("Discount")),1),(0,l.Lk)("td",null,(0,r.v_)(t.currentUser.currency)+" "+(0,r.v_)(X.sale_return.discount.toFixed(2)),1)]),(0,l.Lk)("tr",null,[(0,l.Lk)("td",w,(0,r.v_)(t.$t("Shipping")),1),(0,l.Lk)("td",null,(0,r.v_)(t.currentUser.currency)+" "+(0,r.v_)(X.sale_return.shipping.toFixed(2)),1)]),(0,l.Lk)("tr",null,[(0,l.Lk)("td",null,[(0,l.Lk)("span",D,(0,r.v_)(t.$t("Total")),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("span",P,(0,r.v_)(t.currentUser.currency)+" "+(0,r.v_)(X.GrandTotal.toFixed(2)),1)])])])])]),(0,l.bF)(Y,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{name:"Order Tax",rules:{regex:/^\d*\.?\d*$/}},{default:(0,l.k6)((a=>[(0,l.bF)(M,{label:t.$t("OrderTax")},{default:(0,l.k6)((()=>[(0,l.bF)(H,{append:"%"},{default:(0,l.k6)((()=>[(0,l.bF)(R,{state:K.getValidationState(a),"aria-describedby":"OrderTax-feedback",label:"Order Tax",modelValue:X.sale_return.tax_rate,"onUpdate:modelValue":e[3]||(e[3]=t=>X.sale_return.tax_rate=t),modelModifiers:{number:!0},onKeyup:e[4]||(e[4]=t=>K.keyup_OrderTax())},null,8,["state","modelValue"])])),_:2},1024),(0,l.bF)(A,{id:"OrderTax-feedback"},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,l.bF)(Y,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{name:"Discount",rules:{regex:/^\d*\.?\d*$/}},{default:(0,l.k6)((a=>[(0,l.bF)(M,{label:t.$t("Discount")},{default:(0,l.k6)((()=>[(0,l.bF)(H,{append:t.currentUser.currency},{default:(0,l.k6)((()=>[(0,l.bF)(R,{state:K.getValidationState(a),"aria-describedby":"Discount-feedback",label:"Discount",modelValue:X.sale_return.discount,"onUpdate:modelValue":e[5]||(e[5]=t=>X.sale_return.discount=t),modelModifiers:{number:!0},onKeyup:e[6]||(e[6]=t=>K.keyup_Discount())},null,8,["state","modelValue"])])),_:2},1032,["append"]),(0,l.bF)(A,{id:"Discount-feedback"},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,l.bF)(Y,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,l.k6)((()=>[(0,l.bF)(J,{name:"Shipping",rules:{regex:/^\d*\.?\d*$/}},{default:(0,l.k6)((a=>[(0,l.bF)(M,{label:t.$t("Shipping")},{default:(0,l.k6)((()=>[(0,l.bF)(H,{append:t.currentUser.currency},{default:(0,l.k6)((()=>[(0,l.bF)(R,{state:K.getValidationState(a),"aria-describedby":"Shipping-feedback",label:"Shipping",modelValue:X.sale_return.shipping,"onUpdate:modelValue":e[7]||(e[7]=t=>X.sale_return.shipping=t),modelModifiers:{number:!0},onKeyup:e[8]||(e[8]=t=>K.keyup_Shipping())},null,8,["state","modelValue"])])),_:2},1032,["append"]),(0,l.bF)(A,{id:"Shipping-feedback"},{default:(0,l.k6)((()=>[(0,l.eW)((0,r.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,l.bF)(Y,{md:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(M,{label:t.$t("Please_provide_any_details")},{default:(0,l.k6)((()=>[(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":e[9]||(e[9]=t=>X.sale_return.notes=t),rows:"4",class:"form-control",placeholder:t.$t("Afewwords")},null,8,W),[[s.Jo,X.sale_return.notes]])])),_:1},8,["label"])])),_:1}),(0,l.bF)(Y,{md:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(M,null,{default:(0,l.k6)((()=>[(0,l.bF)(Z,{variant:"primary",onClick:K.Submit_sale_return,disabled:X.SubmitProcessing},{default:(0,l.k6)((()=>[O,(0,l.eW)(" "+(0,r.v_)(t.$t("submit")),1)])),_:1},8,["onClick","disabled"]),e[10]||((0,l.Vq)(-1),e[10]=X.SubmitProcessing?((0,l.uX)(),(0,l.CE)("div",G,Q)):(0,l.Q3)("",!0),(0,l.Vq)(1),e[10])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1},512))])}var K=a(95353),I=a(5947),R=a.n(I);const A={metaInfo:{title:"Create Sale Return"},data(){return{isLoading:!0,SubmitProcessing:!1,details:[],detail:{},sales:[],sale_return:{id:"",date:(new Date).toISOString().slice(0,10),statut:"received",notes:"",client_id:"",warehouse_id:"",sale_id:"",tax_rate:0,TaxNet:0,shipping:0,discount:0},total:0,GrandTotal:0}},computed:{...(0,K.L8)(["currentUser"])},methods:{Submit_sale_return(){this.$refs.create_sale_return.validate().then((t=>{t?this.create_sale_return():this.makeToast("danger",this.$t("Please_fill_the_form_correctly"),this.$t("Failed"))}))},getValidationState({dirty:t,validated:e,valid:a=null}){return t||e?a:null},makeToast(t,e,a){this.$root.$bvToast.toast(e,{title:a,variant:t,solid:!0})},Verified_Qty(t,e){for(var a=0;a<this.details.length;a++)this.details[a].detail_id==e&&(isNaN(t.quantity)&&(this.details[a].quantity=1),t.quantity>t.sale_quantity?(this.makeToast("warning",this.$t("qty_return_is_greater_than_qty_sold"),this.$t("Warning")),this.details[a].quantity=t.sale_quantity):this.details[a].quantity=t.quantity,this.Calcul_Total(),this.$forceUpdate())},increment(t,e){for(var a=0;a<this.details.length;a++)this.details[a].detail_id==e&&(t.quantity+1>t.sale_quantity?this.makeToast("warning",this.$t("qty_return_is_greater_than_qty_sold"),this.$t("Warning")):this.formatNumber(this.details[a].quantity++,2));this.$forceUpdate(),this.Calcul_Total()},decrement(t,e){for(var a=0;a<this.details.length;a++)this.details[a].detail_id==e&&t.quantity-1>0&&(t.quantity-1>t.sale_quantity?this.makeToast("warning",this.$t("qty_return_is_greater_than_qty_sold"),this.$t("Warning")):this.formatNumber(this.details[a].quantity--,2));this.$forceUpdate(),this.Calcul_Total()},formatNumber(t,e){const a=("string"===typeof t?t:t.toString()).split(".");if(e<=0)return a[0];let l=a[1]||"";if(l.length>e)return`${a[0]}.${l.substr(0,e)}`;while(l.length<e)l+="0";return`${a[0]}.${l}`},Calcul_Total(){this.total=0;for(var t=0;t<this.details.length;t++){var e=this.details[t].taxe*this.details[t].quantity;this.details[t].subtotal=parseFloat(this.details[t].quantity*this.details[t].Net_price+e),this.total=parseFloat(this.total+this.details[t].subtotal)}const a=parseFloat(this.total-this.sale_return.discount);this.sale_return.TaxNet=parseFloat(a*this.sale_return.tax_rate/100),this.GrandTotal=parseFloat(a+this.sale_return.TaxNet+this.sale_return.shipping);var l=this.GrandTotal.toFixed(2);this.GrandTotal=parseFloat(l)},keyup_OrderTax(){isNaN(this.sale_return.tax_rate)?this.sale_return.tax_rate=0:""==this.sale_return.tax_rate?(this.sale_return.tax_rate=0,this.Calcul_Total()):this.Calcul_Total()},keyup_Discount(){isNaN(this.sale_return.discount)?this.sale_return.discount=0:""==this.sale_return.discount?(this.sale_return.discount=0,this.Calcul_Total()):this.Calcul_Total()},keyup_Shipping(){isNaN(this.sale_return.shipping)?this.sale_return.shipping=0:""==this.sale_return.shipping?(this.sale_return.shipping=0,this.Calcul_Total()):this.Calcul_Total()},delete_Product_Detail(t){for(var e=0;e<this.details.length;e++)t===this.details[e].detail_id&&(this.details.splice(e,1),this.Calcul_Total())},verifiedForm(){if(this.details.length<=0)return this.makeToast("warning",this.$t("AddProductToList"),this.$t("Warning")),!1;for(var t=0,e=0;e<this.details.length;e++)""==this.details[e].quantity&&0===this.details[e].quantity||(t+=1);return 0!==t||(this.makeToast("warning",this.$t("Please_add_return_quantity"),this.$t("Warning")),!1)},create_sale_return(){this.verifiedForm()&&(this.SubmitProcessing=!0,R().start(),R().set(.1),axios.post("returns/sale",{date:this.sale_return.date,client_id:this.sale_return.client_id,sale_id:this.sale_return.sale_id,warehouse_id:this.sale_return.warehouse_id,statut:this.sale_return.statut,notes:this.sale_return.notes,tax_rate:this.sale_return.tax_rate?this.sale_return.tax_rate:0,TaxNet:this.sale_return.TaxNet?this.sale_return.TaxNet:0,discount:this.sale_return.discount?this.sale_return.discount:0,shipping:this.sale_return.shipping?this.sale_return.shipping:0,GrandTotal:this.GrandTotal,details:this.details}).then((t=>{R().done(),this.makeToast("success",this.$t("Create.TitleReturn"),this.$t("Success")),this.SubmitProcessing=!1,this.$router.push({name:"index_sale_return"})})).catch((t=>{R().done(),this.makeToast("danger",this.$t("InvalidData"),this.$t("Failed")),this.SubmitProcessing=!1})))},GetElements(){let t=this.$route.params.id;axios.get(`returns/sale/create_sell_return/${t}`).then((t=>{this.details=t.data.details,this.sale_return=t.data.sale_return,this.sale_return.date=(new Date).toISOString().slice(0,10),this.Calcul_Total(),this.isLoading=!1})).catch((t=>{setTimeout((()=>{this.isLoading=!1}),500)}))}},created(){this.GetElements()}};var M=a(66262);const J=(0,M.A)(A,[["render",X]]),Y=J}}]);
//# sourceMappingURL=create_sale_return.ffec645f.js.map