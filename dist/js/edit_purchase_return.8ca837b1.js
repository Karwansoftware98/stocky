"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[9260],{31500:(t,e,a)=>{a.r(e),a.d(e,{default:()=>j});var r=a(20641),s=a(53751),i=a(90033);const l={class:"main-content"},u={key:0,class:"loading_page spinner spinner-primary mr-3"},n={class:"table-responsive"},d={class:"table table-hover"},o={class:"bg-gray-300"},c=(0,r.Lk)("th",{scope:"col"},"#",-1),h={scope:"col"},_={scope:"col"},p={scope:"col"},b={scope:"col"},k={scope:"col"},m={scope:"col"},g={scope:"col"},f={scope:"col"},y={key:0},v={colspan:"9"},$=(0,r.Lk)("br",null,null,-1),F={class:"badge badge-success"},L={class:"badge badge-outline-warning"},T={class:"badge badge-outline-warning"},q={class:"quantity"},x=["onClick"],C=["onKeyup","onUpdate:modelValue","disabled"],S=["onClick"],V={class:"offset-md-9 col-md-3 mt-4"},N={class:"table table-striped table-sm"},U={class:"bold"},w={class:"bold"},P={class:"bold"},W={class:"font-weight-bold"},D={class:"font-weight-bold"},G=["placeholder"],E=(0,r.Lk)("i",{class:"i-Yes me-2 font-weight-bold"},null,-1),Q={key:0,class:"typo__p"},O=(0,r.Lk)("div",{class:"spinner sm spinner-primary mt-3"},null,-1),R=[O];function X(t,e,a,O,X,K){const A=(0,r.g2)("breadcumb"),I=(0,r.g2)("b-form-input"),M=(0,r.g2)("b-form-invalid-feedback"),J=(0,r.g2)("b-form-group"),Y=(0,r.g2)("validation-provider"),j=(0,r.g2)("b-col"),z=(0,r.g2)("v-select"),B=(0,r.g2)("b-input-group-prepend"),H=(0,r.g2)("b-input-group-append"),Z=(0,r.g2)("b-input-group"),tt=(0,r.g2)("b-button"),et=(0,r.g2)("b-row"),at=(0,r.g2)("b-card"),rt=(0,r.g2)("b-form"),st=(0,r.g2)("validation-observer");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.bF)(A,{page:t.$t("EditPurchaseReturn"),folder:t.$t("ListReturns")},null,8,["page","folder"]),X.isLoading?((0,r.uX)(),(0,r.CE)("div",u)):(0,r.Q3)("",!0),X.isLoading?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.Wv)(st,{key:1,ref:"edit_Return"},{default:(0,r.k6)((()=>[(0,r.bF)(rt,{onSubmit:(0,s.D$)(K.Submit_purchase_return,["prevent"])},{default:(0,r.k6)((()=>[(0,r.bF)(et,null,{default:(0,r.k6)((()=>[(0,r.bF)(j,{lg:"12",md:"12",sm:"12"},{default:(0,r.k6)((()=>[(0,r.bF)(at,null,{default:(0,r.k6)((()=>[(0,r.bF)(et,null,{default:(0,r.k6)((()=>[(0,r.bF)(j,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(Y,{name:"date",rules:{required:!0}},{default:(0,r.k6)((a=>[(0,r.bF)(J,{label:t.$t("date")+" *"},{default:(0,r.k6)((()=>[(0,r.bF)(I,{state:K.getValidationState(a),"aria-describedby":"date-feedback",type:"date",modelValue:X.purchase_return.date,"onUpdate:modelValue":e[0]||(e[0]=t=>X.purchase_return.date=t)},null,8,["state","modelValue"]),(0,r.bF)(M,{id:"OrderTax-feedback"},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,r.bF)(j,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(J,{label:t.$t("Purchase")},{default:(0,r.k6)((()=>[(0,r.bF)(I,{label:"Purchase",modelValue:X.purchase_return.purchase_ref,"onUpdate:modelValue":e[1]||(e[1]=t=>X.purchase_return.purchase_ref=t),disabled:"disabled"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,r.bF)(j,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(Y,{name:"Status",rules:{required:!0}},{default:(0,r.k6)((()=>[(0,r.bF)(J,{"slot-scope":"{ valid, errors }",label:t.$t("Status")+" *"},{default:(0,r.k6)((()=>[(0,r.bF)(z,{class:(0,i.C4)({"is-invalid":!!t.errors.length}),state:!t.errors[0]&&(!!t.valid||null),modelValue:X.purchase_return.statut,"onUpdate:modelValue":e[2]||(e[2]=t=>X.purchase_return.statut=t),reduce:t=>t.value,placeholder:t.$t("Choose_Status"),options:[{label:"completed",value:"completed"},{label:"pending",value:"pending"}]},null,8,["class","state","modelValue","reduce","placeholder"]),(0,r.bF)(M,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(t.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,r.bF)(j,{md:"12"},{default:(0,r.k6)((()=>[(0,r.Lk)("h5",null,(0,i.v_)(t.$t("list_product_returns"))+" *",1),(0,r.Lk)("div",n,[(0,r.Lk)("table",d,[(0,r.Lk)("thead",o,[(0,r.Lk)("tr",null,[c,(0,r.Lk)("th",h,(0,i.v_)(t.$t("ProductName")),1),(0,r.Lk)("th",_,(0,i.v_)(t.$t("Net_Unit_Cost")),1),(0,r.Lk)("th",p,(0,i.v_)(t.$t("qty_purchased")),1),(0,r.Lk)("th",b,(0,i.v_)(t.$t("Current_stock")),1),(0,r.Lk)("th",k,(0,i.v_)(t.$t("Qty_return")),1),(0,r.Lk)("th",m,(0,i.v_)(t.$t("Discount")),1),(0,r.Lk)("th",g,(0,i.v_)(t.$t("Tax")),1),(0,r.Lk)("th",f,(0,i.v_)(t.$t("SubTotal")),1)])]),(0,r.Lk)("tbody",null,[X.details.length<=0?((0,r.uX)(),(0,r.CE)("tr",y,[(0,r.Lk)("td",v,(0,i.v_)(t.$t("NodataAvailable")),1)])):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(X.details,(e=>((0,r.uX)(),(0,r.CE)("tr",{class:(0,i.C4)({row_deleted:1===e.del||0===e.no_unit}),key:e.detail_id},[(0,r.Lk)("td",null,(0,i.v_)(e.detail_id),1),(0,r.Lk)("td",null,[(0,r.Lk)("span",null,(0,i.v_)(e.code),1),$,(0,r.Lk)("span",F,(0,i.v_)(e.name),1)]),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(K.formatNumber(e.Net_cost,3)),1),(0,r.Lk)("td",null,[(0,r.Lk)("span",L,(0,i.v_)(e.purchase_quantity)+" "+(0,i.v_)(e.unitPurchase),1)]),(0,r.Lk)("td",null,[(0,r.Lk)("span",T,(0,i.v_)(e.stock)+" "+(0,i.v_)(e.unitPurchase),1)]),(0,r.Lk)("td",null,[(0,r.Lk)("div",q,[(0,r.bF)(Z,null,{default:(0,r.k6)((()=>[(0,r.bF)(B,null,{default:(0,r.k6)((()=>[(0,r.bo)((0,r.Lk)("span",{class:"btn btn-primary btn-sm",onClick:t=>K.decrement(e,e.detail_id)},"-",8,x),[[s.aG,0!==e.no_unit]])])),_:2},1024),(0,r.bo)((0,r.Lk)("input",{class:"form-control",onKeyup:t=>K.Verified_Qty(e,e.detail_id),min:0,"onUpdate:modelValue":t=>e.quantity=t,disabled:1===e.del||0===e.no_unit},null,40,C),[[s.Jo,e.quantity,void 0,{number:!0}]]),(0,r.bF)(H,null,{default:(0,r.k6)((()=>[(0,r.bo)((0,r.Lk)("span",{class:"btn btn-primary btn-sm",onClick:t=>K.increment(e,e.detail_id)},"+",8,S),[[s.aG,0!==e.no_unit]])])),_:2},1024)])),_:2},1024)])]),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(K.formatNumber(e.DiscountNet*e.quantity,2)),1),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(K.formatNumber(e.taxe*e.quantity,2)),1),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(e.subtotal.toFixed(2)),1)],2)))),128))])])])])),_:1}),(0,r.Lk)("div",V,[(0,r.Lk)("table",N,[(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",U,(0,i.v_)(t.$t("OrderTax")),1),(0,r.Lk)("td",null,[(0,r.Lk)("span",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(X.purchase_return.TaxNet.toFixed(2))+" ("+(0,i.v_)(K.formatNumber(X.purchase_return.tax_rate,2))+" %)",1)])]),(0,r.Lk)("tr",null,[(0,r.Lk)("td",w,(0,i.v_)(t.$t("Discount")),1),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(X.purchase_return.discount.toFixed(2)),1)]),(0,r.Lk)("tr",null,[(0,r.Lk)("td",P,(0,i.v_)(t.$t("Shipping")),1),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(X.purchase_return.shipping.toFixed(2)),1)]),(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,[(0,r.Lk)("span",W,(0,i.v_)(t.$t("Total")),1)]),(0,r.Lk)("td",null,[(0,r.Lk)("span",D,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(X.GrandTotal.toFixed(2)),1)])])])])]),(0,r.bF)(j,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(Y,{name:"Order Tax",rules:{regex:/^\d*\.?\d*$/}},{default:(0,r.k6)((a=>[(0,r.bF)(J,{label:t.$t("OrderTax")},{default:(0,r.k6)((()=>[(0,r.bF)(Z,{append:"%"},{default:(0,r.k6)((()=>[(0,r.bF)(I,{state:K.getValidationState(a),"aria-describedby":"OrderTax-feedback",label:"Order Tax",modelValue:X.purchase_return.tax_rate,"onUpdate:modelValue":e[3]||(e[3]=t=>X.purchase_return.tax_rate=t),modelModifiers:{number:!0},onKeyup:e[4]||(e[4]=t=>K.keyup_OrderTax())},null,8,["state","modelValue"])])),_:2},1024),(0,r.bF)(M,{id:"OrderTax-feedback"},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,r.bF)(j,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(Y,{name:"Discount",rules:{regex:/^\d*\.?\d*$/}},{default:(0,r.k6)((a=>[(0,r.bF)(J,{label:t.$t("Discount")},{default:(0,r.k6)((()=>[(0,r.bF)(Z,{append:t.currentUser.currency},{default:(0,r.k6)((()=>[(0,r.bF)(I,{state:K.getValidationState(a),"aria-describedby":"Discount-feedback",label:"Discount",modelValue:X.purchase_return.discount,"onUpdate:modelValue":e[5]||(e[5]=t=>X.purchase_return.discount=t),modelModifiers:{number:!0},onKeyup:e[6]||(e[6]=t=>K.keyup_Discount())},null,8,["state","modelValue"])])),_:2},1032,["append"]),(0,r.bF)(M,{id:"Discount-feedback"},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,r.bF)(j,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(Y,{name:"Shipping",rules:{regex:/^\d*\.?\d*$/}},{default:(0,r.k6)((a=>[(0,r.bF)(J,{label:t.$t("Shipping")},{default:(0,r.k6)((()=>[(0,r.bF)(Z,{append:t.currentUser.currency},{default:(0,r.k6)((()=>[(0,r.bF)(I,{state:K.getValidationState(a),"aria-describedby":"Shipping-feedback",label:"Shipping",modelValue:X.purchase_return.shipping,"onUpdate:modelValue":e[7]||(e[7]=t=>X.purchase_return.shipping=t),modelModifiers:{number:!0},onKeyup:e[8]||(e[8]=t=>K.keyup_Shipping())},null,8,["state","modelValue"])])),_:2},1032,["append"]),(0,r.bF)(M,{id:"Shipping-feedback"},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,r.bF)(j,{md:"12"},{default:(0,r.k6)((()=>[(0,r.bF)(J,{label:t.$t("Please_provide_any_details")},{default:(0,r.k6)((()=>[(0,r.bo)((0,r.Lk)("textarea",{"onUpdate:modelValue":e[9]||(e[9]=t=>X.purchase_return.notes=t),rows:"4",class:"form-control",placeholder:t.$t("Afewwords")},null,8,G),[[s.Jo,X.purchase_return.notes]])])),_:1},8,["label"])])),_:1}),(0,r.bF)(j,{md:"12"},{default:(0,r.k6)((()=>[(0,r.bF)(J,null,{default:(0,r.k6)((()=>[(0,r.bF)(tt,{variant:"primary",onClick:K.Submit_purchase_return,disabled:X.SubmitProcessing},{default:(0,r.k6)((()=>[E,(0,r.eW)(" "+(0,i.v_)(t.$t("submit")),1)])),_:1},8,["onClick","disabled"]),e[10]||((0,r.Vq)(-1),e[10]=X.SubmitProcessing?((0,r.uX)(),(0,r.CE)("div",Q,R)):(0,r.Q3)("",!0),(0,r.Vq)(1),e[10])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1},512))])}var K=a(95353),A=a(5947),I=a.n(A);const M={metaInfo:{title:"Edit Return Purchase"},data(){return{isLoading:!0,SubmitProcessing:!1,details:[],detail:{},purchase_return:{id:"",date:"",notes:"",statut:"",supplier_id:"",warehouse_id:"",purchase_id:"",tax_rate:0,TaxNet:0,shipping:0,discount:0},total:0,GrandTotal:0}},computed:{...(0,K.L8)(["currentUser"])},methods:{Submit_purchase_return(){this.$refs.edit_Return.validate().then((t=>{t?this.Update_purchase_return():this.makeToast("danger",this.$t("Please_fill_the_form_correctly"),this.$t("Failed"))}))},getValidationState({dirty:t,validated:e,valid:a=null}){return t||e?a:null},makeToast(t,e,a){this.$root.$bvToast.toast(e,{title:a,variant:t,solid:!0})},Verified_Qty(t,e){for(var a=0;a<this.details.length;a++)this.details[a].detail_id==e&&(isNaN(t.quantity)&&(this.details[a].quantity=1),t.quantity>t.purchase_quantity?(this.makeToast("warning",this.$t("qty_return_is_greater_than_qty_purchased"),this.$t("Warning")),this.details[a].quantity=t.quantity_copy):t.quantity>t.stock?(this.makeToast("warning",this.$t("qty_return_is_greater_than_Quantity_Remaining"),this.$t("Warning")),this.details[a].quantity=t.quantity_copy):this.details[a].quantity=t.quantity,this.Calcul_Total(),this.$forceUpdate())},increment(t,e){for(var a=0;a<this.details.length;a++)this.details[a].detail_id==e&&(t.quantity+1>t.purchase_quantity?this.makeToast("warning",this.$t("qty_return_is_greater_than_qty_purchased"),this.$t("Warning")):t.quantity+1>t.stock?this.makeToast("warning",this.$t("qty_return_is_greater_than_Quantity_Remaining"),this.$t("Warning")):this.formatNumber(this.details[a].quantity++,2));this.$forceUpdate(),this.Calcul_Total()},decrement(t,e){for(var a=0;a<this.details.length;a++)this.details[a].detail_id==e&&t.quantity-1>0&&t.quantity-1>0&&(t.quantity-1>t.purchase_quantity?this.makeToast("warning",this.$t("qty_return_is_greater_than_qty_purchased"),this.$t("Warning")):t.quantity-1>t.stock?this.makeToast("warning",this.$t("qty_return_is_greater_than_Quantity_Remaining"),this.$t("Warning")):this.formatNumber(this.details[a].quantity--,2));this.$forceUpdate(),this.Calcul_Total()},formatNumber(t,e){const a=("string"===typeof t?t:t.toString()).split(".");if(e<=0)return a[0];let r=a[1]||"";if(r.length>e)return`${a[0]}.${r.substr(0,e)}`;while(r.length<e)r+="0";return`${a[0]}.${r}`},Calcul_Total(){this.total=0;for(var t=0;t<this.details.length;t++){var e=this.details[t].taxe*this.details[t].quantity;this.details[t].subtotal=parseFloat(this.details[t].quantity*this.details[t].Net_cost+e),this.total=parseFloat(this.total+this.details[t].subtotal)}const a=parseFloat(this.total-this.purchase_return.discount);this.purchase_return.TaxNet=parseFloat(a*this.purchase_return.tax_rate/100),this.GrandTotal=parseFloat(a+this.purchase_return.TaxNet+this.purchase_return.shipping);var r=this.GrandTotal.toFixed(2);this.GrandTotal=parseFloat(r)},keyup_OrderTax(){isNaN(this.purchase_return.tax_rate)?this.purchase_return.tax_rate=0:""==this.purchase_return.tax_rate?(this.purchase_return.tax_rate=0,this.Calcul_Total()):this.Calcul_Total()},keyup_Discount(){isNaN(this.purchase_return.discount)?this.purchase_return.discount=0:""==this.purchase_return.discount?(this.purchase_return.discount=0,this.Calcul_Total()):this.Calcul_Total()},keyup_Shipping(){isNaN(this.purchase_return.shipping)?this.purchase_return.shipping=0:""==this.purchase_return.shipping?(this.purchase_return.shipping=0,this.Calcul_Total()):this.Calcul_Total()},verifiedForm(){if(this.details.length<=0)return this.makeToast("warning",this.$t("AddProductToList"),this.$t("Warning")),!1;for(var t=0,e=0;e<this.details.length;e++)""==this.details[e].quantity&&0===this.details[e].quantity||(t+=1);return 0!==t||(this.makeToast("warning",this.$t("Please_add_return_quantity"),this.$t("Warning")),!1)},Update_purchase_return(){if(this.verifiedForm()){this.SubmitProcessing=!0,I().start(),I().set(.1);let t=this.$route.params.id;axios.put(`returns/purchase/${t}`,{date:this.purchase_return.date,supplier_id:this.purchase_return.supplier_id,warehouse_id:this.purchase_return.warehouse_id,purchase_id:this.purchase_return.purchase_id,statut:this.purchase_return.statut,notes:this.purchase_return.notes,tax_rate:this.purchase_return.tax_rate?this.purchase_return.tax_rate:0,TaxNet:this.purchase_return.TaxNet?this.purchase_return.TaxNet:0,discount:this.purchase_return.discount?this.purchase_return.discount:0,shipping:this.purchase_return.shipping?this.purchase_return.shipping:0,GrandTotal:this.GrandTotal,details:this.details}).then((t=>{I().done(),this.makeToast("success",this.$t("Update.TitleReturn"),this.$t("Success")),this.SubmitProcessing=!1,this.$router.push({name:"index_purchase_return"})})).catch((t=>{I().done(),this.makeToast("danger",this.$t("InvalidData"),this.$t("Failed")),this.SubmitProcessing=!1}))}},GetElements(){let t=this.$route.params.id,e=this.$route.params.purchase_id;axios.get(`returns/purchase/edit_purchase_return/${t}/${e}`).then((t=>{this.purchase_return=t.data.purchase_return,this.details=t.data.details,this.Calcul_Total(),this.isLoading=!1})).catch((t=>{setTimeout((()=>{this.isLoading=!1}),500)}))}},created(){this.GetElements()}};var J=a(66262);const Y=(0,J.A)(M,[["render",X]]),j=Y}}]);
//# sourceMappingURL=edit_purchase_return.8ca837b1.js.map