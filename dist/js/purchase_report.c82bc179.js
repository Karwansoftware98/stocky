"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[2779],{35437:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Q});var s=a(20641),l=a(90033),r=a(53751);const i={class:"main-content"},o={key:0,class:"loading_page spinner spinner-primary mr-3"},n={slot:"table-actions",class:"mt-2 mb-3"},d=(0,s.Lk)("i",{class:"i-Filter-2"},null,-1),u=(0,s.Lk)("i",{class:"i-File-Copy"},null,-1),p=(0,s.Lk)("i",{class:"i-File-Excel"},null,-1),h={slot:"table-row","slot-scope":"props"},c={key:0},m={key:0,class:"badge badge-outline-success"},g={key:1,class:"badge badge-outline-info"},_={key:2,class:"badge badge-outline-warning"},b={key:1},f={key:0,class:"badge badge-outline-success"},v={key:1,class:"badge badge-outline-primary"},F={key:2,class:"badge badge-outline-warning"},P={class:"px-3 py-2"},k=(0,s.Lk)("option",{value:"",selected:""},"All",-1),y=(0,s.Lk)("option",{value:"received"},"Received",-1),C=(0,s.Lk)("option",{value:"pending"},"Pending",-1),w=(0,s.Lk)("option",{value:"ordered"},"Ordered",-1),R=[k,y,C,w],S=(0,s.Lk)("option",{value:"",selected:""},"All",-1),$=(0,s.Lk)("option",{value:"paid"},"Paid",-1),x=(0,s.Lk)("option",{value:"partial"},"partial",-1),D=(0,s.Lk)("option",{value:"unpaid"},"UnPaid",-1),L=[S,$,x,D],O=(0,s.Lk)("i",{class:"i-Filter-2"},null,-1),V=(0,s.Lk)("i",{class:"i-Power-2"},null,-1);function X(e,t,a,k,y,C){const w=(0,s.g2)("breadcumb"),S=(0,s.g2)("date-range-picker"),$=(0,s.g2)("b-col"),x=(0,s.g2)("b-button"),D=(0,s.g2)("vue-excel-xlsx"),X=(0,s.g2)("vue-good-table"),E=(0,s.g2)("b-card"),W=(0,s.g2)("b-form-input"),G=(0,s.g2)("b-form-group"),T=(0,s.g2)("v-select"),U=(0,s.g2)("b-row"),N=(0,s.g2)("b-sidebar"),K=(0,s.gN)("b-toggle");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.bF)(w,{page:e.$t("PurchasesReport"),folder:e.$t("Reports")},null,8,["page","folder"]),y.isLoading?((0,s.uX)(),(0,s.CE)("div",o)):(0,s.Q3)("",!0),y.isLoading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)($,{key:1,md:"12",class:"text-center"},{default:(0,s.k6)((()=>[(0,s.bF)(S,{modelValue:y.dateRange,"onUpdate:modelValue":t[0]||(t[0]=e=>y.dateRange=e),startDate:y.startDate,endDate:y.endDate,onUpdate:C.Submit_filter_dateRange,"locale-data":y.locale},{input:(0,s.k6)((e=>[(0,s.eW)((0,l.v_)(e.startDate.toJSON().slice(0,10))+" - "+(0,l.v_)(e.endDate.toJSON().slice(0,10)),1)])),_:1},8,["modelValue","startDate","endDate","onUpdate","locale-data"])])),_:1})),y.isLoading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(E,{key:2,class:"wrapper"},{default:(0,s.k6)((()=>[(0,s.bF)(X,{mode:"remote",columns:C.columns,totalRows:y.totalRows,rows:y.rows,"group-options":{enabled:!0,headerPosition:"bottom"},onOnPageChange:C.onPageChange,onOnPerPageChange:C.onPerPageChange,onOnSortChange:C.onSortChange,onOnSearch:C.onSearch,"search-options":{placeholder:e.$t("Search_this_table"),enabled:!0},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"order-table vgt-table"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",n,[(0,s.bo)(((0,s.uX)(),(0,s.Wv)(x,{variant:"outline-info ripple m-1",size:"sm"},{default:(0,s.k6)((()=>[d,(0,s.eW)(" "+(0,l.v_)(e.$t("Filter")),1)])),_:1})),[[K,void 0,void 0,{"sidebar-right":!0}]]),(0,s.bF)(x,{onClick:t[1]||(t[1]=e=>C.Purchase_PDF()),size:"sm",variant:"outline-success ripple m-1"},{default:(0,s.k6)((()=>[u,(0,s.eW)(" PDF ")])),_:1}),(0,s.bF)(D,{class:"btn btn-sm btn-outline-danger ripple m-1",data:y.purchases,columns:C.columns,"file-name":"purchases_report","file-type":"xlsx","sheet-name":"purchases_report"},{default:(0,s.k6)((()=>[p,(0,s.eW)(" EXCEL ")])),_:1},8,["data","columns"])]),(0,s.Lk)("template",h,["statut"==e.props.column.field?((0,s.uX)(),(0,s.CE)("div",c,["received"==e.props.row.statut?((0,s.uX)(),(0,s.CE)("span",m,(0,l.v_)(e.$t("Received")),1)):"pending"==e.props.row.statut?((0,s.uX)(),(0,s.CE)("span",g,(0,l.v_)(e.$t("Pending")),1)):((0,s.uX)(),(0,s.CE)("span",_,(0,l.v_)(e.$t("Ordered")),1))])):"payment_status"==e.props.column.field?((0,s.uX)(),(0,s.CE)("div",b,["paid"==e.props.row.payment_status?((0,s.uX)(),(0,s.CE)("span",f,(0,l.v_)(e.$t("Paid")),1)):"partial"==e.props.row.payment_status?((0,s.uX)(),(0,s.CE)("span",v,(0,l.v_)(e.$t("partial")),1)):((0,s.uX)(),(0,s.CE)("span",F,(0,l.v_)(e.$t("Unpaid")),1))])):(0,s.Q3)("",!0)])])),_:1},8,["columns","totalRows","rows","onOnPageChange","onOnPerPageChange","onOnSortChange","onOnSearch","search-options"])])),_:1})),(0,s.bF)(N,{id:"sidebar-right",title:e.$t("Filter"),"bg-variant":"white",right:"",shadow:""},{default:(0,s.k6)((()=>[(0,s.Lk)("div",P,[(0,s.bF)(U,null,{default:(0,s.k6)((()=>[(0,s.bF)($,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(G,{label:e.$t("Reference")},{default:(0,s.k6)((()=>[(0,s.bF)(W,{label:"Reference",placeholder:e.$t("Reference"),modelValue:y.Filter_Ref,"onUpdate:modelValue":t[2]||(t[2]=e=>y.Filter_Ref=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"])])),_:1}),(0,s.bF)($,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(G,{label:e.$t("Supplier")},{default:(0,s.k6)((()=>[(0,s.bF)(T,{reduce:e=>e.value,placeholder:e.$t("Choose_Supplier"),modelValue:y.Filter_Supplier,"onUpdate:modelValue":t[3]||(t[3]=e=>y.Filter_Supplier=e),options:y.suppliers.map((e=>({label:e.name,value:e.id})))},null,8,["reduce","placeholder","modelValue","options"])])),_:1},8,["label"])])),_:1}),(0,s.bF)($,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(G,{label:e.$t("warehouse")},{default:(0,s.k6)((()=>[(0,s.bF)(T,{modelValue:y.Filter_warehouse,"onUpdate:modelValue":t[4]||(t[4]=e=>y.Filter_warehouse=e),reduce:e=>e.value,placeholder:e.$t("Choose_Warehouse"),options:y.warehouses.map((e=>({label:e.name,value:e.id})))},null,8,["modelValue","reduce","placeholder","options"])])),_:1},8,["label"])])),_:1}),(0,s.bF)($,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(G,{label:e.$t("Status")},{default:(0,s.k6)((()=>[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>y.Filter_status=e),type:"text",class:"form-control"},R,512),[[r.u1,y.Filter_status]])])),_:1},8,["label"])])),_:1}),(0,s.bF)($,{md:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(G,{label:e.$t("PaymentStatus")},{default:(0,s.k6)((()=>[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>y.Filter_Payment=e),type:"text",class:"form-control"},L,512),[[r.u1,y.Filter_Payment]])])),_:1},8,["label"])])),_:1}),(0,s.bF)($,{md:"6",sm:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(x,{onClick:t[7]||(t[7]=e=>C.Get_Purchases(y.serverParams.page)),variant:"primary ripple m-1",size:"sm",block:""},{default:(0,s.k6)((()=>[O,(0,s.eW)(" "+(0,l.v_)(e.$t("Filter")),1)])),_:1})])),_:1}),(0,s.bF)($,{md:"6",sm:"12"},{default:(0,s.k6)((()=>[(0,s.bF)(x,{onClick:t[8]||(t[8]=e=>C.Reset_Filter()),variant:"danger ripple m-1",size:"sm",block:""},{default:(0,s.k6)((()=>[V,(0,s.eW)(" "+(0,l.v_)(e.$t("Reset")),1)])),_:1})])),_:1})])),_:1})])])),_:1},8,["title"])])}var E=a(5947),W=a.n(E),G=a(44323),T=(a(13246),a(32464)),U=a.n(T),N=a(95093),K=a.n(N);const J={metaInfo:{title:"Report Purchases"},components:{DateRangePicker:U()},data(){return{isLoading:!0,serverParams:{sort:{field:"id",type:"desc"},page:1,perPage:10},limit:"10",search:"",totalRows:"",Filter_Supplier:"",Filter_status:"",Filter_warehouse:"",Filter_Payment:"",Filter_Ref:"",suppliers:[],purchases:[],warehouses:[],rows:[{statut:"Total",children:[]}],today_mode:!0,startDate:"",endDate:"",dateRange:{startDate:"",endDate:""},locale:{Label:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:K().weekdaysMin(),monthNames:K().monthsShort(),firstDay:1}}},computed:{columns(){return[{label:this.$t("date"),field:"date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Reference"),field:"Ref",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Supplier"),field:"provider_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("warehouse"),field:"warehouse_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Status"),field:"statut",html:!0,tdClass:"text-left",thClass:"text-left"},{label:this.$t("Total"),field:"GrandTotal",type:"decimal",headerField:this.sumCount,tdClass:"text-left",thClass:"text-left"},{label:this.$t("Paid"),field:"paid_amount",type:"decimal",headerField:this.sumCount2,tdClass:"text-left",thClass:"text-left"},{label:this.$t("Due"),field:"due",type:"decimal",headerField:this.sumCount3,tdClass:"text-left",thClass:"text-left"},{label:this.$t("PaymentStatus"),field:"payment_status",html:!0,tdClass:"text-left",thClass:"text-left"}]}},methods:{sumCount(e){let t=0;for(let a=0;a<e.children.length;a++)t+=e.children[a].GrandTotal;return t},sumCount2(e){let t=0;for(let a=0;a<e.children.length;a++)t+=e.children[a].paid_amount;return t},sumCount3(e){let t=0;for(let a=0;a<e.children.length;a++)t+=e.children[a].due;return t},updateParams(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange({currentPage:e}){this.serverParams.page!==e&&(this.updateParams({page:e}),this.Get_Purchases(e))},onPerPageChange({currentPerPage:e}){this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.Get_Purchases(1))},onSortChange(e){let t="";t="provider_name"==e[0].field?"provider_id":e[0].field,this.updateParams({sort:{type:e[0].type,field:t}}),this.Get_Purchases(this.serverParams.page)},onSearch(e){this.search=e.searchTerm,this.Get_Purchases(this.serverParams.page)},Reset_Filter(){this.search="",this.Filter_Supplier="",this.Filter_status="",this.Filter_Payment="",this.Filter_Ref="",this.Filter_warehouse="",this.Get_Purchases(this.serverParams.page)},Purchase_PDF(){var e=this;let t=new G["default"]("p","pt"),a=[{title:"Ref",dataKey:"Ref"},{title:"Provider",dataKey:"provider_name"},{title:"Warehouse",dataKey:"warehouse_name"},{title:"Status",dataKey:"statut"},{title:"Total",dataKey:"GrandTotal"},{title:"Paid",dataKey:"paid_amount"},{title:"Due",dataKey:"due"},{title:"Status Payment",dataKey:"payment_status"}];t.autoTable(a,e.purchases),t.text("Purchase report",40,25),t.save("Purchase_report.pdf")},setToStrings(){null===this.Filter_Supplier?this.Filter_Supplier="":null===this.Filter_warehouse&&(this.Filter_warehouse="")},Submit_filter_dateRange(){var e=this;e.startDate=e.dateRange.startDate.toJSON().slice(0,10),e.endDate=e.dateRange.endDate.toJSON().slice(0,10),e.Get_Purchases(1)},get_data_loaded(){var e=this;if(e.today_mode){let t=new Date;e.startDate=t.getFullYear(),e.endDate=(new Date).toJSON().slice(0,10),e.dateRange.startDate=t.getFullYear(),e.dateRange.endDate=(new Date).toJSON().slice(0,10)}},Get_Purchases(e){W().start(),W().set(.1),this.setToStrings(),this.get_data_loaded(),axios.get("/report/purchases?page="+e+"&Ref="+this.Filter_Ref+"&provider_id="+this.Filter_Supplier+"&warehouse_id="+this.Filter_warehouse+"&statut="+this.Filter_status+"&payment_statut="+this.Filter_Payment+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit+"&to="+this.endDate+"&from="+this.startDate).then((e=>{this.purchases=e.data.purchases,this.suppliers=e.data.suppliers,this.warehouses=e.data.warehouses,this.totalRows=e.data.totalRows,this.rows[0].children=this.purchases,W().done(),this.isLoading=!1,this.today_mode=!1})).catch((e=>{W().done(),setTimeout((()=>{this.isLoading=!1,this.today_mode=!1}),500)}))},formatNumber(e,t){const a=("string"===typeof e?e:e.toString()).split(".");if(t<=0)return a[0];let s=a[1]||"";if(s.length>t)return`${a[0]}.${s.substr(0,t)}`;while(s.length<t)s+="0";return`${a[0]}.${s}`}},created:function(){this.Get_Purchases(1)}};var z=a(66262);const A=(0,z.A)(J,[["render",X]]),Q=A}}]);
//# sourceMappingURL=purchase_report.c82bc179.js.map