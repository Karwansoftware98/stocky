"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[6121],{47102:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P});var l=a(20641),s=a(90033);const r={class:"main-content"},i={key:0,class:"loading_page spinner spinner-primary mr-3"},o={class:"table table-hover table-sm"},n={slot:"table-actions",class:"mt-2 mb-3"},d=(0,l.Lk)("i",{class:"i-Filter-2"},null,-1),u=(0,l.Lk)("i",{class:"i-File-Copy"},null,-1),c=(0,l.Lk)("i",{class:"i-File-Excel"},null,-1),_={slot:"table-row","slot-scope":"props"},h={key:0},b={class:"ul-btn__text ml-1"},m={key:1},p={class:"px-3 py-2"},f=(0,l.Lk)("i",{class:"i-Filter-2"},null,-1),g=(0,l.Lk)("i",{class:"i-Power-2"},null,-1);function k(e,t,a,k,F,v){const C=(0,l.g2)("breadcumb"),w=(0,l.g2)("date-range-picker"),y=(0,l.g2)("b-col"),R=(0,l.g2)("b-button"),L=(0,l.g2)("vue-excel-xlsx"),S=(0,l.g2)("router-link"),D=(0,l.g2)("vue-good-table"),$=(0,l.g2)("b-tab"),x=(0,l.g2)("b-tabs"),P=(0,l.g2)("b-card"),V=(0,l.g2)("b-row"),O=(0,l.g2)("b-form-input"),W=(0,l.g2)("b-form-group"),N=(0,l.g2)("v-select"),U=(0,l.g2)("b-sidebar"),X=(0,l.gN)("b-toggle");return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.bF)(C,{page:e.$t("product_report"),folder:e.$t("Reports")},null,8,["page","folder"]),F.isLoading?((0,l.uX)(),(0,l.CE)("div",i)):(0,l.Q3)("",!0),F.isLoading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(V,{key:1},{default:(0,l.k6)((()=>[(0,l.bF)(y,{md:"12",class:"text-center"},{default:(0,l.k6)((()=>[(0,l.bF)(w,{modelValue:F.dateRange,"onUpdate:modelValue":t[0]||(t[0]=e=>F.dateRange=e),startDate:F.startDate,endDate:F.endDate,onUpdate:v.Submit_filter_dateRange,"locale-data":F.locale},{input:(0,l.k6)((e=>[(0,l.eW)((0,s.v_)(e.startDate.toJSON().slice(0,10))+" - "+(0,s.v_)(e.endDate.toJSON().slice(0,10)),1)])),_:1},8,["modelValue","startDate","endDate","onUpdate","locale-data"])])),_:1}),"is_variant"==F.product.type?((0,l.uX)(),(0,l.Wv)(y,{key:0,md:"5",class:"mt-4"},{default:(0,l.k6)((()=>[(0,l.Lk)("table",o,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,(0,s.v_)(e.$t("Variant_code")),1),(0,l.Lk)("th",null,(0,s.v_)(e.$t("Variant_Name")),1),(0,l.Lk)("th",null,(0,s.v_)(e.$t("Variant_price")),1)])]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(F.product.products_variants_data,(t=>((0,l.uX)(),(0,l.CE)("tr",null,[(0,l.Lk)("td",null,(0,s.v_)(t.code),1),(0,l.Lk)("td",null,(0,s.v_)(t.name),1),(0,l.Lk)("td",null,(0,s.v_)(e.currentUser.currency)+" "+(0,s.v_)(t.price),1)])))),256))])])])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(y,{md:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(P,{class:"card mb-30","header-bg-variant":"transparent "},{default:(0,l.k6)((()=>[(0,l.bF)(x,{"active-nav-item-class":"nav nav-tabs","content-class":"mt-3"},{default:(0,l.k6)((()=>[(0,l.bF)($,{title:e.$t("Sales")},{default:(0,l.k6)((()=>[(0,l.bF)(D,{mode:"remote",columns:v.columns_sales,totalRows:F.totalRows_sales,rows:F.sales,onOnPageChange:v.PageChangeSales,onOnPerPageChange:v.onPerPageChangeSales,onOnSearch:v.onSearch_sales,"search-options":{placeholder:e.$t("Search_this_table"),enabled:!0},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"tableOne table-hover vgt-table"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",n,[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(R,{variant:"outline-info ripple m-1",size:"sm"},{default:(0,l.k6)((()=>[d,(0,l.eW)(" "+(0,s.v_)(e.$t("Filter")),1)])),_:1})),[[X,void 0,void 0,{"sidebar-right":!0}]]),(0,l.bF)(R,{onClick:t[1]||(t[1]=e=>v.Sales_PDF()),size:"sm",variant:"outline-success ripple m-1"},{default:(0,l.k6)((()=>[u,(0,l.eW)(" PDF ")])),_:1}),(0,l.bF)(L,{class:"btn btn-sm btn-outline-danger ripple m-1",data:F.sales,columns:v.columns_sales,"file-name":"product_report","file-type":"xlsx","sheet-name":"product_report"},{default:(0,l.k6)((()=>[c,(0,l.eW)(" EXCEL ")])),_:1},8,["data","columns"])]),(0,l.Lk)("template",_,["Ref"==e.props.column.field?((0,l.uX)(),(0,l.CE)("div",h,[(0,l.bF)(S,{to:"/app/sales/detail/"+e.props.row.sale_id},{default:(0,l.k6)((()=>[(0,l.Lk)("span",b,(0,s.v_)(e.props.row.Ref),1)])),_:1},8,["to"])])):"total"==e.props.column.field?((0,l.uX)(),(0,l.CE)("div",m,[(0,l.Lk)("span",null,(0,s.v_)(e.currentUser.currency)+" "+(0,s.v_)(e.props.row.total),1)])):(0,l.Q3)("",!0)])])),_:1},8,["columns","totalRows","rows","onOnPageChange","onOnPerPageChange","onOnSearch","search-options"])])),_:1},8,["title"])])),_:1})])),_:1})])),_:1})])),_:1})),(0,l.bF)(U,{id:"sidebar-right",title:e.$t("Filter"),"bg-variant":"white",right:"",shadow:""},{default:(0,l.k6)((()=>[(0,l.Lk)("div",p,[(0,l.bF)(V,null,{default:(0,l.k6)((()=>[(0,l.bF)(y,{md:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(W,{label:e.$t("Reference")},{default:(0,l.k6)((()=>[(0,l.bF)(O,{label:"Reference",placeholder:e.$t("Reference"),modelValue:F.Filter_Ref,"onUpdate:modelValue":t[2]||(t[2]=e=>F.Filter_Ref=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.bF)(y,{md:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(W,{label:e.$t("Customer")},{default:(0,l.k6)((()=>[(0,l.bF)(N,{reduce:e=>e.value,placeholder:e.$t("Choose_Customer"),modelValue:F.Filter_Client,"onUpdate:modelValue":t[3]||(t[3]=e=>F.Filter_Client=e),options:F.customers.map((e=>({label:e.name,value:e.id})))},null,8,["reduce","placeholder","modelValue","options"])])),_:1},8,["label"])])),_:1}),(0,l.bF)(y,{md:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(W,{label:e.$t("warehouse")},{default:(0,l.k6)((()=>[(0,l.bF)(N,{modelValue:F.Filter_warehouse,"onUpdate:modelValue":t[4]||(t[4]=e=>F.Filter_warehouse=e),reduce:e=>e.value,placeholder:e.$t("Choose_Warehouse"),options:F.warehouses.map((e=>({label:e.name,value:e.id})))},null,8,["modelValue","reduce","placeholder","options"])])),_:1},8,["label"])])),_:1}),(0,l.bF)(y,{md:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(W,{label:"Vendeur"},{default:(0,l.k6)((()=>[(0,l.bF)(N,{reduce:e=>e.value,placeholder:"Choose Vendeur",modelValue:F.Filter_user,"onUpdate:modelValue":t[5]||(t[5]=e=>F.Filter_user=e),options:F.users.map((e=>({label:e.username,value:e.id})))},null,8,["reduce","modelValue","options"])])),_:1})])),_:1}),(0,l.bF)(y,{md:"6",sm:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(R,{onClick:t[6]||(t[6]=e=>v.Get_Sales(1)),variant:"primary btn-block ripple m-1",size:"sm"},{default:(0,l.k6)((()=>[f,(0,l.eW)(" "+(0,s.v_)(e.$t("Filter")),1)])),_:1})])),_:1}),(0,l.bF)(y,{md:"6",sm:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(R,{onClick:t[7]||(t[7]=e=>v.Reset_Filter()),variant:"danger ripple btn-block m-1",size:"sm"},{default:(0,l.k6)((()=>[g,(0,l.eW)(" "+(0,s.v_)(e.$t("Reset")),1)])),_:1})])),_:1})])),_:1})])])),_:1},8,["title"])])}var F=a(95353),v=a(44323),C=(a(13246),a(32464)),w=a.n(C),y=a(95093),R=a.n(y),L=a(5947),S=a.n(L);const D={metaInfo:{title:"Products Report"},components:{DateRangePicker:w()},data(){return{totalRows_sales:"",limit_sales:"10",sales_page:1,search_sales:"",Filter_Client:"",Filter_Ref:"",Filter_warehouse:"",Filter_user:"",isLoading:!0,sales:[],warehouses:[],customers:[],users:[],product:{},today_mode:!0,startDate:"",endDate:"",dateRange:{startDate:"",endDate:""},locale:{Label:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:R().weekdaysMin(),monthNames:R().monthsShort(),firstDay:1}}},computed:{...(0,F.L8)(["currentUser"]),columns_sales(){return[{label:this.$t("date"),field:"date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Reference"),field:"Ref",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Created_by"),field:"created_by",tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("product_name"),field:"product_name",tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Customer"),field:"client_name",tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("warehouse"),field:"warehouse_name",tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Quantity"),field:"quantity",tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("SubTotal"),field:"total",tdClass:"text-left",thClass:"text-left",sortable:!1}]}},methods:{Reset_Filter(){this.search="",this.Filter_Client="",this.Filter_Ref="",this.Filter_warehouse="",this.Filter_user="",this.Get_Sales(1)},Sales_PDF(){var e=this;let t=new v["default"]("p","pt"),a=[{title:"Date",dataKey:"date"},{title:"Ref",dataKey:"Ref"},{title:"Created_by",dataKey:"created_by"},{title:"Product Name",dataKey:"product_name"},{title:"Client",dataKey:"client_name"},{title:"Warehouse",dataKey:"warehouse_name"},{title:"Quantity",dataKey:"quantity"},{title:"SubTotal",dataKey:"total"}];t.autoTable(a,e.sales),t.text("Sale List",40,25),t.save("Sale_List.pdf")},formatNumber(e,t){const a=("string"===typeof e?e:e.toString()).split(".");if(t<=0)return a[0];let l=a[1]||"";if(l.length>t)return`${a[0]}.${l.substr(0,t)}`;while(l.length<t)l+="0";return`${a[0]}.${l}`},PageChangeSales({currentPage:e}){this.sales_page!==e&&this.Get_Sales(e)},onPerPageChangeSales({currentPerPage:e}){this.limit_sales!==e&&(this.limit_sales=e,this.Get_Sales(1))},onSearch_sales(e){this.search_sales=e.searchTerm,this.Get_Sales(1)},Submit_filter_dateRange(){var e=this;e.startDate=e.dateRange.startDate.toJSON().slice(0,10),e.endDate=e.dateRange.endDate.toJSON().slice(0,10),e.Get_Sales(1)},get_data_loaded(){var e=this;if(e.today_mode){let t=new Date;e.startDate=t.getFullYear(),e.endDate=(new Date).toJSON().slice(0,10),e.dateRange.startDate=t.getFullYear(),e.dateRange.endDate=(new Date).toJSON().slice(0,10)}},showDetails(){let e=this.$route.params.id;axios.get(`get_product_detail/${e}`).then((e=>{this.product=e.data})).catch((e=>{}))},Get_Sales(e){S().start(),S().set(.1),this.get_data_loaded(),axios.get("/report/sale_products_details?page="+e+"&Ref="+this.Filter_Ref+"&client_id="+this.Filter_Client+"&warehouse_id="+this.Filter_warehouse+"&user_id="+this.Filter_user+"&limit="+this.limit_sales+"&to="+this.endDate+"&from="+this.startDate+"&search="+this.search_sales+"&id="+this.$route.params.id).then((e=>{this.sales=e.data.sales,this.totalRows_sales=e.data.totalRows,this.customers=e.data.customers,this.warehouses=e.data.warehouses,this.users=e.data.users,S().done(),this.isLoading=!1,this.today_mode=!1})).catch((e=>{S().done(),setTimeout((()=>{this.isLoading=!1,this.today_mode=!1}),500)}))}},created:function(){this.showDetails(),this.Get_Sales(1)}};var $=a(66262);const x=(0,$.A)(D,[["render",k]]),P=x}}]);
//# sourceMappingURL=detail_product_report.fbb09e6b.js.map