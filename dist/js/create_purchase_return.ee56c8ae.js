"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[8576],{18803:(t,e,a)=>{a.r(e),a.d(e,{default:()=>z});var r=a(20641),s=a(53751),i=a(90033);const l={class:"main-content"},u={key:0,class:"loading_page spinner spinner-primary mr-3"},n={class:"alert alert-danger"},d={class:"table-responsive"},o={class:"table table-hover"},c={class:"bg-gray-300"},h=(0,r.Lk)("th",{scope:"col"},"#",-1),_={scope:"col"},p={scope:"col"},b={scope:"col"},k={scope:"col"},m={scope:"col"},g={scope:"col"},f={scope:"col"},v={scope:"col"},y={key:0},$={colspan:"9"},L=(0,r.Lk)("br",null,null,-1),F={class:"badge badge-success"},T={class:"badge badge-outline-warning"},x={class:"badge badge-outline-warning"},q={class:"quantity"},C=["onClick"],S=["onKeyup","onUpdate:modelValue"],V=["onClick"],N={class:"offset-md-9 col-md-3 mt-4"},w={class:"table table-striped table-sm"},U={class:"bold"},P={class:"bold"},W={class:"bold"},D={class:"font-weight-bold"},R={class:"font-weight-bold"},O=["placeholder"],Q=(0,r.Lk)("i",{class:"i-Yes me-2 font-weight-bold"},null,-1),G={key:0,class:"typo__p"},E=(0,r.Lk)("div",{class:"spinner sm spinner-primary mt-3"},null,-1),X=[E];function K(t,e,a,E,K,I){const A=(0,r.g2)("breadcumb"),M=(0,r.g2)("b-form-input"),J=(0,r.g2)("b-form-invalid-feedback"),Y=(0,r.g2)("b-form-group"),j=(0,r.g2)("validation-provider"),z=(0,r.g2)("b-col"),B=(0,r.g2)("v-select"),H=(0,r.g2)("b-input-group-prepend"),Z=(0,r.g2)("b-input-group-append"),tt=(0,r.g2)("b-input-group"),et=(0,r.g2)("b-button"),at=(0,r.g2)("b-row"),rt=(0,r.g2)("b-card"),st=(0,r.g2)("b-form"),it=(0,r.g2)("validation-observer");return(0,r.uX)(),(0,r.CE)("div",l,[(0,r.bF)(A,{page:t.$t("CreatePurchaseReturn"),folder:t.$t("ListReturns")},null,8,["page","folder"]),K.isLoading?((0,r.uX)(),(0,r.CE)("div",u)):(0,r.Q3)("",!0),K.isLoading?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.Wv)(it,{key:1,ref:"create_Return"},{default:(0,r.k6)((()=>[(0,r.bF)(st,{onSubmit:(0,s.D$)(I.Submit_Return_Purchase,["prevent"])},{default:(0,r.k6)((()=>[(0,r.bF)(at,null,{default:(0,r.k6)((()=>[(0,r.bF)(z,{lg:"12",md:"12",sm:"12"},{default:(0,r.k6)((()=>[(0,r.bF)(rt,null,{default:(0,r.k6)((()=>[(0,r.bF)(at,null,{default:(0,r.k6)((()=>[(0,r.bF)(z,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(j,{name:"date",rules:{required:!0}},{default:(0,r.k6)((a=>[(0,r.bF)(Y,{label:t.$t("date")+" *"},{default:(0,r.k6)((()=>[(0,r.bF)(M,{state:I.getValidationState(a),"aria-describedby":"date-feedback",type:"date",modelValue:K.purchase_return.date,"onUpdate:modelValue":e[0]||(e[0]=t=>K.purchase_return.date=t)},null,8,["state","modelValue"]),(0,r.bF)(J,{id:"OrderTax-feedback"},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,r.bF)(z,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(Y,{label:t.$t("Purchase")},{default:(0,r.k6)((()=>[(0,r.bF)(M,{label:"Purchase",modelValue:K.purchase_return.purchase_ref,"onUpdate:modelValue":e[1]||(e[1]=t=>K.purchase_return.purchase_ref=t),disabled:"disabled"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),(0,r.bF)(z,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(j,{name:"Status",rules:{required:!0}},{default:(0,r.k6)((()=>[(0,r.bF)(Y,{"slot-scope":"{ valid, errors }",label:t.$t("Status")+" *"},{default:(0,r.k6)((()=>[(0,r.bF)(B,{class:(0,i.C4)({"is-invalid":!!t.errors.length}),state:!t.errors[0]&&(!!t.valid||null),modelValue:K.purchase_return.statut,"onUpdate:modelValue":e[2]||(e[2]=t=>K.purchase_return.statut=t),reduce:t=>t.value,placeholder:t.$t("Choose_Status"),options:[{label:"completed",value:"completed"},{label:"pending",value:"pending"}]},null,8,["class","state","modelValue","reduce","placeholder"]),(0,r.bF)(J,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(t.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,r.bF)(z,{md:"12"},{default:(0,r.k6)((()=>[(0,r.Lk)("h5",null,(0,i.v_)(t.$t("list_product_returns"))+" *",1),(0,r.Lk)("div",n,(0,i.v_)(t.$t("products_refunded_alert")),1),(0,r.Lk)("div",d,[(0,r.Lk)("table",o,[(0,r.Lk)("thead",c,[(0,r.Lk)("tr",null,[h,(0,r.Lk)("th",_,(0,i.v_)(t.$t("ProductName")),1),(0,r.Lk)("th",p,(0,i.v_)(t.$t("Net_Unit_Cost")),1),(0,r.Lk)("th",b,(0,i.v_)(t.$t("qty_purchased")),1),(0,r.Lk)("th",k,(0,i.v_)(t.$t("Current_stock")),1),(0,r.Lk)("th",m,(0,i.v_)(t.$t("Qty_return")),1),(0,r.Lk)("th",g,(0,i.v_)(t.$t("Discount")),1),(0,r.Lk)("th",f,(0,i.v_)(t.$t("Tax")),1),(0,r.Lk)("th",v,(0,i.v_)(t.$t("SubTotal")),1)])]),(0,r.Lk)("tbody",null,[K.details.length<=0?((0,r.uX)(),(0,r.CE)("tr",y,[(0,r.Lk)("td",$,(0,i.v_)(t.$t("NodataAvailable")),1)])):(0,r.Q3)("",!0),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(K.details,(e=>((0,r.uX)(),(0,r.CE)("tr",null,[(0,r.Lk)("td",null,(0,i.v_)(e.detail_id),1),(0,r.Lk)("td",null,[(0,r.Lk)("span",null,(0,i.v_)(e.code),1),L,(0,r.Lk)("span",F,(0,i.v_)(e.name),1)]),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(I.formatNumber(e.Net_cost,3)),1),(0,r.Lk)("td",null,[(0,r.Lk)("span",T,(0,i.v_)(e.purchase_quantity)+" "+(0,i.v_)(e.unitPurchase),1)]),(0,r.Lk)("td",null,[(0,r.Lk)("span",x,(0,i.v_)(e.stock)+" "+(0,i.v_)(e.unitPurchase),1)]),(0,r.Lk)("td",null,[(0,r.Lk)("div",q,[(0,r.bF)(tt,null,{default:(0,r.k6)((()=>[(0,r.bF)(H,null,{default:(0,r.k6)((()=>[(0,r.Lk)("span",{class:"btn btn-primary btn-sm",onClick:t=>I.decrement(e,e.detail_id)},"-",8,C)])),_:2},1024),(0,r.bo)((0,r.Lk)("input",{class:"form-control",onKeyup:t=>I.Verified_Qty(e,e.detail_id),min:0,"onUpdate:modelValue":t=>e.quantity=t},null,40,S),[[s.Jo,e.quantity,void 0,{number:!0}]]),(0,r.bF)(Z,null,{default:(0,r.k6)((()=>[(0,r.Lk)("span",{class:"btn btn-primary btn-sm",onClick:t=>I.increment(e,e.detail_id)},"+",8,V)])),_:2},1024)])),_:2},1024)])]),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(I.formatNumber(e.DiscountNet*e.quantity,2)),1),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(I.formatNumber(e.taxe*e.quantity,2)),1),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(e.subtotal.toFixed(2)),1)])))),256))])])])])),_:1}),(0,r.Lk)("div",N,[(0,r.Lk)("table",w,[(0,r.Lk)("tbody",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("td",U,(0,i.v_)(t.$t("OrderTax")),1),(0,r.Lk)("td",null,[(0,r.Lk)("span",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(K.purchase_return.TaxNet.toFixed(2))+" ("+(0,i.v_)(I.formatNumber(K.purchase_return.tax_rate,2))+" %)",1)])]),(0,r.Lk)("tr",null,[(0,r.Lk)("td",P,(0,i.v_)(t.$t("Discount")),1),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(K.purchase_return.discount.toFixed(2)),1)]),(0,r.Lk)("tr",null,[(0,r.Lk)("td",W,(0,i.v_)(t.$t("Shipping")),1),(0,r.Lk)("td",null,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(K.purchase_return.shipping.toFixed(2)),1)]),(0,r.Lk)("tr",null,[(0,r.Lk)("td",null,[(0,r.Lk)("span",D,(0,i.v_)(t.$t("Total")),1)]),(0,r.Lk)("td",null,[(0,r.Lk)("span",R,(0,i.v_)(t.currentUser.currency)+" "+(0,i.v_)(K.GrandTotal.toFixed(2)),1)])])])])]),(0,r.bF)(z,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(j,{name:"Order Tax",rules:{regex:/^\d*\.?\d*$/}},{default:(0,r.k6)((a=>[(0,r.bF)(Y,{label:t.$t("OrderTax")},{default:(0,r.k6)((()=>[(0,r.bF)(tt,{append:"%"},{default:(0,r.k6)((()=>[(0,r.bF)(M,{state:I.getValidationState(a),"aria-describedby":"OrderTax-feedback",label:"Order Tax",modelValue:K.purchase_return.tax_rate,"onUpdate:modelValue":e[3]||(e[3]=t=>K.purchase_return.tax_rate=t),modelModifiers:{number:!0},onKeyup:e[4]||(e[4]=t=>I.keyup_OrderTax())},null,8,["state","modelValue"])])),_:2},1024),(0,r.bF)(J,{id:"OrderTax-feedback"},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,r.bF)(z,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(j,{name:"Discount",rules:{regex:/^\d*\.?\d*$/}},{default:(0,r.k6)((a=>[(0,r.bF)(Y,{label:t.$t("Discount")},{default:(0,r.k6)((()=>[(0,r.bF)(tt,{append:t.currentUser.currency},{default:(0,r.k6)((()=>[(0,r.bF)(M,{state:I.getValidationState(a),"aria-describedby":"Discount-feedback",label:"Discount",modelValue:K.purchase_return.discount,"onUpdate:modelValue":e[5]||(e[5]=t=>K.purchase_return.discount=t),modelModifiers:{number:!0},onKeyup:e[6]||(e[6]=t=>I.keyup_Discount())},null,8,["state","modelValue"])])),_:2},1032,["append"]),(0,r.bF)(J,{id:"Discount-feedback"},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,r.bF)(z,{lg:"4",md:"4",sm:"12",class:"mb-3"},{default:(0,r.k6)((()=>[(0,r.bF)(j,{name:"Shipping",rules:{regex:/^\d*\.?\d*$/}},{default:(0,r.k6)((a=>[(0,r.bF)(Y,{label:t.$t("Shipping")},{default:(0,r.k6)((()=>[(0,r.bF)(tt,{append:t.currentUser.currency},{default:(0,r.k6)((()=>[(0,r.bF)(M,{state:I.getValidationState(a),"aria-describedby":"Shipping-feedback",label:"Shipping",modelValue:K.purchase_return.shipping,"onUpdate:modelValue":e[7]||(e[7]=t=>K.purchase_return.shipping=t),modelModifiers:{number:!0},onKeyup:e[8]||(e[8]=t=>I.keyup_Shipping())},null,8,["state","modelValue"])])),_:2},1032,["append"]),(0,r.bF)(J,{id:"Shipping-feedback"},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,r.bF)(z,{md:"12"},{default:(0,r.k6)((()=>[(0,r.bF)(Y,{label:t.$t("Please_provide_any_details")},{default:(0,r.k6)((()=>[(0,r.bo)((0,r.Lk)("textarea",{"onUpdate:modelValue":e[9]||(e[9]=t=>K.purchase_return.notes=t),rows:"4",class:"form-control",placeholder:t.$t("Afewwords")},null,8,O),[[s.Jo,K.purchase_return.notes]])])),_:1},8,["label"])])),_:1}),(0,r.bF)(z,{md:"12"},{default:(0,r.k6)((()=>[(0,r.bF)(Y,null,{default:(0,r.k6)((()=>[(0,r.bF)(et,{variant:"primary",onClick:I.Submit_Return_Purchase,disabled:K.SubmitProcessing},{default:(0,r.k6)((()=>[Q,(0,r.eW)(" "+(0,i.v_)(t.$t("submit")),1)])),_:1},8,["onClick","disabled"]),e[10]||((0,r.Vq)(-1),e[10]=K.SubmitProcessing?((0,r.uX)(),(0,r.CE)("div",G,X)):(0,r.Q3)("",!0),(0,r.Vq)(1),e[10])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1},512))])}var I=a(95353),A=a(5947),M=a.n(A);const J={metaInfo:{title:"Create Return Purchase"},data(){return{isLoading:!0,SubmitProcessing:!1,details:[],detail:{},purchases:[],purchase_return:{id:"",date:(new Date).toISOString().slice(0,10),statut:"completed",notes:"",supplier_id:"",warehouse_id:"",purchase_id:"",tax_rate:0,TaxNet:0,shipping:0,discount:0},total:0,GrandTotal:0}},computed:{...(0,I.L8)(["currentUser"])},methods:{Submit_Return_Purchase(){this.$refs.create_Return.validate().then((t=>{t?this.Create_Return_Purchase():this.makeToast("danger",this.$t("Please_fill_the_form_correctly"),this.$t("Failed"))}))},getValidationState({dirty:t,validated:e,valid:a=null}){return t||e?a:null},makeToast(t,e,a){this.$root.$bvToast.toast(e,{title:a,variant:t,solid:!0})},Verified_Qty(t,e){for(var a=0;a<this.details.length;a++)this.details[a].detail_id==e&&(isNaN(t.quantity)&&(this.details[a].quantity=1),t.quantity>t.purchase_quantity?(this.makeToast("warning",this.$t("qty_return_is_greater_than_qty_purchased"),this.$t("Warning")),this.details[a].quantity=0):t.quantity>t.stock?(this.makeToast("warning",this.$t("qty_return_is_greater_than_Quantity_Remaining"),this.$t("Warning")),this.details[a].quantity=0):this.details[a].quantity=t.quantity,this.Calcul_Total(),this.$forceUpdate())},increment(t,e){for(var a=0;a<this.details.length;a++)this.details[a].detail_id==e&&(t.quantity+1>t.purchase_quantity?this.makeToast("warning",this.$t("qty_return_is_greater_than_qty_purchased"),this.$t("Warning")):t.quantity+1>t.stock?this.makeToast("warning",this.$t("qty_return_is_greater_than_Quantity_Remaining"),this.$t("Warning")):this.formatNumber(this.details[a].quantity++,2));this.$forceUpdate(),this.Calcul_Total()},decrement(t,e){for(var a=0;a<this.details.length;a++)this.details[a].detail_id==e&&t.quantity-1>0&&(t.quantity-1>t.purchase_quantity?this.makeToast("warning",this.$t("qty_return_is_greater_than_qty_purchased"),this.$t("Warning")):t.quantity-1>t.stock?this.makeToast("warning",this.$t("qty_return_is_greater_than_Quantity_Remaining"),this.$t("Warning")):this.formatNumber(this.details[a].quantity--,2));this.$forceUpdate(),this.Calcul_Total()},formatNumber(t,e){const a=("string"===typeof t?t:t.toString()).split(".");if(e<=0)return a[0];let r=a[1]||"";if(r.length>e)return`${a[0]}.${r.substr(0,e)}`;while(r.length<e)r+="0";return`${a[0]}.${r}`},Calcul_Total(){this.total=0;for(var t=0;t<this.details.length;t++){var e=this.details[t].taxe*this.details[t].quantity;this.details[t].subtotal=parseFloat(this.details[t].quantity*this.details[t].Net_cost+e),this.total=parseFloat(this.total+this.details[t].subtotal)}const a=parseFloat(this.total-this.purchase_return.discount);this.purchase_return.TaxNet=parseFloat(a*this.purchase_return.tax_rate/100),this.GrandTotal=parseFloat(a+this.purchase_return.TaxNet+this.purchase_return.shipping);var r=this.GrandTotal.toFixed(2);this.GrandTotal=parseFloat(r)},keyup_OrderTax(){isNaN(this.purchase_return.tax_rate)?this.purchase_return.tax_rate=0:""==this.purchase_return.tax_rate?(this.purchase_return.tax_rate=0,this.Calcul_Total()):this.Calcul_Total()},keyup_Discount(){isNaN(this.purchase_return.discount)?this.purchase_return.discount=0:""==this.purchase_return.discount?(this.purchase_return.discount=0,this.Calcul_Total()):this.Calcul_Total()},keyup_Shipping(){isNaN(this.purchase_return.shipping)?this.purchase_return.shipping=0:""==this.purchase_return.shipping?(this.purchase_return.shipping=0,this.Calcul_Total()):this.Calcul_Total()},verifiedForm(){if(this.details.length<=0)return this.makeToast("warning",this.$t("AddProductToList"),this.$t("Warning")),!1;for(var t=0,e=0;e<this.details.length;e++)""==this.details[e].quantity&&0===this.details[e].quantity||(t+=1);return 0!==t||(this.makeToast("warning",this.$t("Please_add_return_quantity"),this.$t("Warning")),!1)},Create_Return_Purchase(){this.verifiedForm()&&(this.SubmitProcessing=!0,M().start(),M().set(.1),axios.post("returns/purchase",{date:this.purchase_return.date,supplier_id:this.purchase_return.supplier_id,purchase_id:this.purchase_return.purchase_id,warehouse_id:this.purchase_return.warehouse_id,statut:this.purchase_return.statut,notes:this.purchase_return.notes,tax_rate:this.purchase_return.tax_rate?this.purchase_return.tax_rate:0,TaxNet:this.purchase_return.TaxNet?this.purchase_return.TaxNet:0,discount:this.purchase_return.discount?this.purchase_return.discount:0,shipping:this.purchase_return.shipping?this.purchase_return.shipping:0,GrandTotal:this.GrandTotal,details:this.details}).then((t=>{M().done(),this.makeToast("success",this.$t("Create.TitleReturn"),this.$t("Success")),this.SubmitProcessing=!1,this.$router.push({name:"index_purchase_return"})})).catch((t=>{M().done(),this.makeToast("danger",this.$t("InvalidData"),this.$t("Failed")),this.SubmitProcessing=!1})))},GetElements(){let t=this.$route.params.id;axios.get(`returns/purchase/create_purchase_return/${t}`).then((t=>{this.details=t.data.details,this.purchase_return=t.data.purchase_return,this.purchase_return.date=(new Date).toISOString().slice(0,10),this.Calcul_Total(),this.isLoading=!1})).catch((t=>{setTimeout((()=>{this.isLoading=!1}),500)}))}},created(){this.GetElements()}};var Y=a(66262);const j=(0,Y.A)(J,[["render",K]]),z=j}}]);
//# sourceMappingURL=create_purchase_return.ee56c8ae.js.map