"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[987],{94282:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S});var l=a(20641),s=a(90033),d=a(53751);const i={class:"main-content"},n={key:0,class:"loading_page spinner spinner-primary mr-3"},o={slot:"selected-row-actions"},r={slot:"table-actions",class:"mt-2 mb-3"},p=(0,l.Lk)("i",{class:"i-Add"},null,-1),_={slot:"table-row","slot-scope":"props"},m={key:0},h=(0,l.Lk)("i",{class:"i-Edit text-25 text-success"},null,-1),c=[h],u=(0,l.Lk)("i",{class:"i-Close-Window text-25 text-danger"},null,-1),v=[u],b=["state"],f=(0,l.Lk)("i",{class:"i-Yes me-2 font-weight-bold"},null,-1),y={key:0,class:"typo__p"},g=(0,l.Lk)("div",{class:"spinner sm spinner-primary mt-3"},null,-1),$=[g];function k(e,t,a,h,u,g){const k=(0,l.g2)("breadcumb"),C=(0,l.g2)("b-button"),F=(0,l.g2)("vue-good-table"),L=(0,l.g2)("b-card"),w=(0,l.g2)("v-select"),x=(0,l.g2)("b-form-invalid-feedback"),D=(0,l.g2)("b-form-group"),S=(0,l.g2)("validation-provider"),P=(0,l.g2)("b-col"),T=(0,l.g2)("Datepicker"),V=(0,l.g2)("b-form-textarea"),E=(0,l.g2)("b-row"),q=(0,l.g2)("b-form"),G=(0,l.g2)("b-modal"),A=(0,l.g2)("validation-observer"),I=(0,l.gN)("b-tooltip");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.bF)(k,{page:e.$t("Leave_request"),folder:e.$t("hrm")},null,8,["page","folder"]),u.isLoading?((0,l.uX)(),(0,l.CE)("div",n)):(0,l.Q3)("",!0),u.isLoading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(L,{key:1,class:"wrapper"},{default:(0,l.k6)((()=>[(0,l.bF)(F,{mode:"remote",columns:g.columns,totalRows:u.totalRows,rows:u.leaves,onOnPageChange:g.onPageChange,onOnPerPageChange:g.onPerPageChange,onOnSortChange:g.onSortChange,onOnSearch:g.onSearch,"search-options":{enabled:!0,placeholder:e.$t("Search_this_table")},"select-options":{enabled:!0,clearSelectionText:""},onOnSelectedRowsChange:g.selectionChanged,"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"table-hover tableOne vgt-table"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",o,[(0,l.Lk)("button",{class:"btn btn-danger btn-sm",onClick:t[0]||(t[0]=e=>g.delete_by_selected())},(0,s.v_)(e.$t("Del")),1)]),(0,l.Lk)("div",r,[(0,l.bF)(C,{onClick:t[1]||(t[1]=e=>g.New_Leave()),class:"btn-rounded",variant:"btn btn-primary btn-icon m-1"},{default:(0,l.k6)((()=>[p,(0,l.eW)(" "+(0,s.v_)(e.$t("Add")),1)])),_:1})]),(0,l.Lk)("template",_,["actions"==e.props.column.field?((0,l.uX)(),(0,l.CE)("span",m,[(0,l.bo)(((0,l.uX)(),(0,l.CE)("a",{onClick:t[2]||(t[2]=t=>g.Edit_Leave(e.props.row)),class:"cursor-pointer",title:"Edit"},c)),[[I,void 0,void 0,{hover:!0}]]),(0,l.bo)(((0,l.uX)(),(0,l.CE)("a",{title:"Delete",class:"cursor-pointer",onClick:t[3]||(t[3]=t=>g.Remove_Leave(e.props.row.id))},v)),[[I,void 0,void 0,{hover:!0}]])])):(0,l.Q3)("",!0)])])),_:1},8,["columns","totalRows","rows","onOnPageChange","onOnPerPageChange","onOnSortChange","onOnSearch","search-options","onOnSelectedRowsChange"])])),_:1})),(0,l.bF)(A,{ref:"Create_Leave"},{default:(0,l.k6)((()=>[(0,l.bF)(G,{"hide-footer":"",size:"lg",id:"New_Modal_Leave",title:u.editmode?e.$t("Edit"):e.$t("Add")},{default:(0,l.k6)((()=>[(0,l.bF)(q,{onSubmit:(0,d.D$)(g.Submit_Leave,["prevent"])},{default:(0,l.k6)((()=>[(0,l.bF)(E,null,{default:(0,l.k6)((()=>[(0,l.bF)(P,{md:"6"},{default:(0,l.k6)((()=>[(0,l.bF)(S,{name:"Company",rules:{required:!0}},{default:(0,l.k6)((()=>[(0,l.bF)(D,{"slot-scope":"{ valid, errors }",label:e.$t("Company")+" *"},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:(0,s.C4)([{"is-invalid":!!e.errors.length},"required"]),state:!e.errors[0]&&(!!e.valid||null),modelValue:u.leave.company_id,"onUpdate:modelValue":t[4]||(t[4]=e=>u.leave.company_id=e),required:"",onInput:g.Selected_Company,placeholder:e.$t("Choose_Company"),reduce:e=>e.value,options:u.companies.map((e=>({label:e.name,value:e.id})))},null,8,["class","state","modelValue","onInput","placeholder","reduce","options"]),(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,l.bF)(P,{md:"6"},{default:(0,l.k6)((()=>[(0,l.bF)(S,{name:"Department",rules:{required:!0}},{default:(0,l.k6)((()=>[(0,l.bF)(D,{"slot-scope":"{ valid, errors }",label:e.$t("Department")+" *"},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:(0,s.C4)([{"is-invalid":!!e.errors.length},"required"]),state:!e.errors[0]&&(!!e.valid||null),modelValue:u.leave.department_id,"onUpdate:modelValue":t[5]||(t[5]=e=>u.leave.department_id=e),required:"",onInput:g.Selected_Department,placeholder:e.$t("Department"),reduce:e=>e.value,options:u.departments.map((e=>({label:e.department,value:e.id})))},null,8,["class","state","modelValue","onInput","placeholder","reduce","options"]),(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,l.bF)(P,{md:"6"},{default:(0,l.k6)((()=>[(0,l.bF)(S,{name:"Employee",rules:{required:!0}},{default:(0,l.k6)((()=>[(0,l.bF)(D,{"slot-scope":"{ valid, errors }",label:e.$t("Employee")+" *"},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:(0,s.C4)([{"is-invalid":!!e.errors.length},"required"]),state:!e.errors[0]&&(!!e.valid||null),modelValue:u.leave.employee_id,"onUpdate:modelValue":t[6]||(t[6]=e=>u.leave.employee_id=e),required:"",onInput:g.Selected_Employee,placeholder:e.$t("Choose_Employee"),reduce:e=>e.value,options:u.employees.map((e=>({label:e.username,value:e.id})))},null,8,["class","state","modelValue","onInput","placeholder","reduce","options"]),(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,l.bF)(P,{md:"6"},{default:(0,l.k6)((()=>[(0,l.bF)(S,{name:"leave_type",rules:{required:!0}},{default:(0,l.k6)((()=>[(0,l.bF)(D,{"slot-scope":"{ valid, errors }",label:e.$t("Leave_Type")+" *"},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:(0,s.C4)([{"is-invalid":!!e.errors.length},"required"]),state:!e.errors[0]&&(!!e.valid||null),modelValue:u.leave.leave_type_id,"onUpdate:modelValue":t[7]||(t[7]=e=>u.leave.leave_type_id=e),required:"",onInput:g.Selected_Leave_Type,placeholder:e.$t("Choose_leave_type"),reduce:e=>e.value,options:u.leave_types.map((e=>({label:e.title,value:e.id})))},null,8,["class","state","modelValue","onInput","placeholder","reduce","options"]),(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,l.bF)(P,{md:"6"},{default:(0,l.k6)((()=>[(0,l.bF)(S,{name:"start_date",rules:{required:!0}},{default:(0,l.k6)((a=>[(0,l.bF)(D,{label:e.$t("start_date")+" *"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{id:"start_date",name:"start_date",placeholder:e.$t("Enter_Start_date"),modelValue:u.leave.start_date,"onUpdate:modelValue":t[8]||(t[8]=e=>u.leave.start_date=e),"input-class":"form-control back_important",format:"yyyy-MM-dd",onClosed:t[9]||(t[9]=e=>u.leave.start_date=g.formatDate(u.leave.start_date))},null,8,["placeholder","modelValue"]),(0,l.bF)(x,{id:"start_date-feedback"},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,l.bF)(P,{md:"6"},{default:(0,l.k6)((()=>[(0,l.bF)(S,{name:"Finish_Date",rules:{required:!0}},{default:(0,l.k6)((a=>[(0,l.bF)(D,{label:e.$t("Finish_Date")},{default:(0,l.k6)((()=>[(0,l.bF)(T,{id:"end_date",name:"end_date",placeholder:e.$t("Enter_Finish_date"),modelValue:u.leave.end_date,"onUpdate:modelValue":t[10]||(t[10]=e=>u.leave.end_date=e),"input-class":"form-control back_important",format:"yyyy-MM-dd",onClosed:t[11]||(t[11]=e=>u.leave.end_date=g.formatDate(u.leave.end_date))},null,8,["placeholder","modelValue"]),(0,l.bF)(x,{id:"end_date-feedback"},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(a.errors[0]),1)])),_:2},1024)])),_:2},1032,["label"])])),_:1})])),_:1}),(0,l.bF)(P,{lg:"6",md:"6",sm:"12",class:"mb-2"},{default:(0,l.k6)((()=>[(0,l.bF)(S,{name:"Status",rules:{required:!0}},{default:(0,l.k6)((()=>[(0,l.bF)(D,{"slot-scope":"{ valid, errors }",label:e.$t("Status")+" *"},{default:(0,l.k6)((()=>[(0,l.bF)(w,{class:(0,s.C4)({"is-invalid":!!e.errors.length}),state:!e.errors[0]&&(!!e.valid||null),modelValue:u.leave.status,"onUpdate:modelValue":t[12]||(t[12]=e=>u.leave.status=e),reduce:e=>e.value,placeholder:e.$t("Choose_status"),options:[{label:"Approved",value:"approved"},{label:"Pending",value:"pending"},{label:"Rejected",value:"rejected"}]},null,8,["class","state","modelValue","reduce","placeholder"]),(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1})])),_:1}),(0,l.bF)(P,{md:"6"},{default:(0,l.k6)((()=>[(0,l.bF)(S,{name:"Attachment",ref:"Attachment",rules:"mimes:image/*|size:2048"},{default:(0,l.k6)((()=>[(0,l.bF)(D,{"slot-scope":"{validate, valid, errors }",label:e.$t("Attachment")},{default:(0,l.k6)((()=>[(0,l.Lk)("input",{state:!e.errors[0]&&(!!e.valid||null),class:(0,s.C4)({"is-invalid":!!e.errors.length}),onChange:t[13]||(t[13]=(...e)=>g.changeAttachement&&g.changeAttachement(...e)),label:"Choose Attachment",type:"file"},null,42,b),(0,l.bF)(x,{id:"Attachment-feedback"},{default:(0,l.k6)((()=>[(0,l.eW)((0,s.v_)(e.errors[0]),1)])),_:1})])),_:1},8,["label"])])),_:1},512)])),_:1}),(0,l.bF)(P,{md:"12"},{default:(0,l.k6)((()=>[(0,l.bF)(D,{label:e.$t("Leave_Reason")},{default:(0,l.k6)((()=>[(0,l.bF)(V,{rows:"3",placeholder:e.$t("Enter_Reason_Leave"),label:"Leave_Reason",modelValue:u.leave.reason,"onUpdate:modelValue":t[14]||(t[14]=e=>u.leave.reason=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"])])),_:1}),(0,l.bF)(P,{md:"12",class:"mt-3"},{default:(0,l.k6)((()=>[(0,l.bF)(C,{variant:"primary",type:"submit",disabled:u.SubmitProcessing},{default:(0,l.k6)((()=>[f,(0,l.eW)(" "+(0,s.v_)(e.$t("submit")),1)])),_:1},8,["disabled"]),t[15]||((0,l.Vq)(-1),t[15]=u.SubmitProcessing?((0,l.uX)(),(0,l.CE)("div",y,$)):(0,l.Q3)("",!0),(0,l.Vq)(1),t[15])])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1},8,["title"])])),_:1},512)])}var C=a(5947),F=a.n(C),L=a(56045);const w={metaInfo:{title:"Leave"},components:{Datepicker:L.A},data(){return{isLoading:!0,SubmitProcessing:!1,serverParams:{columnFilters:{},sort:{field:"id",type:"desc"},page:1,perPage:10},data:new FormData,selectedIds:[],totalRows:"",search:"",limit:"10",editmode:!1,employees:[],companies:[],departments:[],leave_types:[],leaves:[],leave:{company_id:"",department_id:"",employee_id:"",leave_type_id:"",start_date:"",end_date:"",days:"",reason:"",attachment:"",half_day:"",status:""}}},computed:{columns(){return[{label:this.$t("Employee"),field:"employee_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Company"),field:"company_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Department"),field:"department_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Leave_Type"),field:"leave_type_title",tdClass:"text-left",thClass:"text-left"},{label:this.$t("start_date"),field:"start_date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Finish_Date"),field:"end_date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Days"),field:"days",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Status"),field:"status",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Action"),field:"actions",html:!0,tdClass:"text-right",thClass:"text-right",sortable:!1}]}},methods:{updateParams(e){this.serverParams=Object.assign({},this.serverParams,e)},onPageChange({currentPage:e}){this.serverParams.page!==e&&(this.updateParams({page:e}),this.Get_Leaves(e))},onPerPageChange({currentPerPage:e}){this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.Get_Leaves(1))},selectionChanged({selectedRows:e}){this.selectedIds=[],e.forEach(((e,t)=>{this.selectedIds.push(e.id)}))},onSortChange(e){let t="";t="company_name"==e[0].field?"company_id":"department_name"==e[0].field?"department_id":"employee_name"==e[0].field?"employee_id":"leave_type_title"==e[0].field?"leave_type_id":e[0].field,this.updateParams({sort:{type:e[0].type,field:e[0].field}}),this.Get_Leaves(this.serverParams.page)},onSearch(e){this.search=e.searchTerm,this.Get_Leaves(this.serverParams.page)},getValidationState({dirty:e,validated:t,valid:a=null}){return e||t?a:null},formatDate(e){var t=e.getMonth()+1,a=t<10?"0"+t:t,l=e.getDate(),s=l<10?"0"+l:l;return[e.getFullYear(),a,s].join("-")},async changeAttachement(e){const{valid:t}=await this.$refs.Attachment.validate(e);this.leave.attachment=t?e.target.files[0]:""},Submit_Leave(){this.$refs.Create_Leave.validate().then((e=>{e?this.editmode?this.Update_Leave():this.Create_Leave():this.makeToast("danger",this.$t("Please_fill_the_form_correctly"),this.$t("Failed"))}))},makeToast(e,t,a){this.$root.$bvToast.toast(t,{title:a,variant:e,solid:!0})},New_Leave(){this.reset_Form(),this.editmode=!1,this.Get_Data_Create()},Edit_Leave(e){this.editmode=!0,this.reset_Form(),this.Get_Data_Edit(e.id)},Selected_Employee(e){null===e&&(this.leave.employee_id="")},Selected_Leave_Type(e){null===e&&(this.leave.leave_type_id="")},Selected_Status(e){null===e&&(this.leave.status="")},Selected_Company(e){null===e&&(this.leave.company_id=""),this.employees=[],this.departments=[],this.leave.employee_id="",this.leave.department_id="",this.Get_departments_by_company(e)},Selected_Department(e){null===e&&(this.leave.department_id="",this.leave.employee_id=""),this.employee_id=[],this.leave.employee_id="",this.Get_employees_by_department(e)},Get_departments_by_company(e){axios.get("/core/get_departments_by_company?id="+e).then((({data:e})=>this.departments=e))},Get_employees_by_department(e){axios.get("/get_employees_by_department?id="+e).then((({data:e})=>this.employees=e))},Get_Data_Create(){axios.get("/leave/create").then((e=>{this.companies=e.data.companies,this.leave_types=e.data.leave_types,this.$bvModal.show("New_Modal_Leave")})).catch((e=>{}))},Get_Data_Edit(e){axios.get(`leave/${e}/edit`).then((e=>{this.leave=e.data.leave,this.companies=e.data.companies,this.leave_types=e.data.leave_types,this.Get_departments_by_company(this.leave.company_id),this.Get_employees_by_department(this.leave.department_id),this.leave.attachment="",this.$bvModal.show("New_Modal_Leave")})).catch((e=>{}))},Get_Leaves(e){F().start(),F().set(.1),axios.get("leave?page="+e+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit).then((e=>{this.totalRows=e.data.totalRows,this.leaves=e.data.leaves,F().done(),this.isLoading=!1})).catch((e=>{F().done(),setTimeout((()=>{this.isLoading=!1}),500)}))},Create_Leave(){var e=this;e.SubmitProcessing=!0,e.data.append("company_id",e.leave.company_id),e.data.append("department_id",e.leave.department_id),e.data.append("employee_id",e.leave.employee_id),e.data.append("leave_type_id",e.leave.leave_type_id),e.data.append("start_date",e.leave.start_date),e.data.append("end_date",e.leave.end_date),e.data.append("reason",e.leave.reason),e.data.append("attachment",e.leave.attachment),e.data.append("half_day",e.leave.half_day?1:0),e.data.append("status",e.leave.status),axios.post("/leave",e.data).then((t=>{0==t.data.isvalid?(e.SubmitProcessing=!1,e.errors={},this.makeToast("danger",this.$t("remaining_leaves_are_insufficient"),this.$t("Failed"))):(this.SubmitProcessing=!1,Fire.$emit("Event_Leave"),this.makeToast("success",this.$t("Created_in_successfully"),this.$t("Success")))})).catch((e=>{this.SubmitProcessing=!1,this.makeToast("danger",this.$t("InvalidData"),this.$t("Failed"))}))},Update_Leave(){var e=this;e.SubmitProcessing=!0,e.data.append("company_id",e.leave.company_id),e.data.append("department_id",e.leave.department_id),e.data.append("employee_id",e.leave.employee_id),e.data.append("leave_type_id",e.leave.leave_type_id),e.data.append("start_date",e.leave.start_date),e.data.append("end_date",e.leave.end_date),e.data.append("reason",e.leave.reason),e.data.append("attachment",e.leave.attachment),e.data.append("half_day",e.leave.half_day?1:0),e.data.append("status",e.leave.status),e.data.append("_method","put"),axios.post("/leave/"+e.leave.id,e.data).then((t=>{0==t.data.isvalid?(e.SubmitProcessing=!1,e.errors={},this.makeToast("danger",this.$t("remaining_leaves_are_insufficient"),this.$t("Failed"))):(this.SubmitProcessing=!1,Fire.$emit("Event_Leave"),this.makeToast("success",this.$t("Updated_in_successfully"),this.$t("Success")))})).catch((e=>{this.SubmitProcessing=!1,this.makeToast("danger",this.$t("InvalidData"),this.$t("Failed"))}))},reset_Form(){this.leave={id:"",company_id:"",department_id:"",employee_id:"",leave_type_id:"",start_date:"",end_date:"",days:"",reason:"",attachment:"",half_day:"",status:""}},Remove_Leave(e){this.$swal({title:this.$t("Delete.Title"),text:this.$t("Delete.Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete.cancelButtonText"),confirmButtonText:this.$t("Delete.confirmButtonText")}).then((t=>{t.value&&axios.delete("leave/"+e).then((()=>{this.$swal(this.$t("Delete.Deleted"),this.$t("Deleted_in_successfully"),"success"),Fire.$emit("Delete_Leave")})).catch((()=>{this.$swal(this.$t("Delete.Failed"),this.$t("Delete.Therewassomethingwronge"),"warning")}))}))},delete_by_selected(){this.$swal({title:this.$t("Delete.Title"),text:this.$t("Delete.Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete.cancelButtonText"),confirmButtonText:this.$t("Delete.confirmButtonText")}).then((e=>{e.value&&(F().start(),F().set(.1),axios.post("leave/delete/by_selection",{selectedIds:this.selectedIds}).then((()=>{this.$swal(this.$t("Delete.Deleted"),this.$t("Deleted_in_successfully"),"success"),Fire.$emit("Delete_Leave")})).catch((()=>{setTimeout((()=>F().done()),500),this.$swal(this.$t("Delete.Failed"),this.$t("Delete.Therewassomethingwronge"),"warning")})))}))}},created:function(){this.Get_Leaves(1),Fire.$on("Event_Leave",(()=>{setTimeout((()=>{this.Get_Leaves(this.serverParams.page),this.$bvModal.hide("New_Modal_Leave")}),500)})),Fire.$on("Delete_Leave",(()=>{setTimeout((()=>{this.Get_Leaves(this.serverParams.page)}),500)}))}};var x=a(66262);const D=(0,x.A)(w,[["render",k]]),S=D}}]);
//# sourceMappingURL=leave_list.25f75ad3.js.map